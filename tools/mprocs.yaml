# Configuration for mprocs to run the dev environment locally.
# Requirements:
# * mprocs (`brew install mprocs`)
# * bacon (`cargo install --locked bacon`)

# ⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️
# you need to restart front-workers after sdks-js is loaded: select front-workers in the mprocs window and press r
# ⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️

procs:
  core:
    cwd: "<CONFIG_DIR>/../core"
    shell: "bacon core-api"
  sqlite-workers:
    cwd: "<CONFIG_DIR>/../core"
    env:
      CORE_API: "http://localhost:3001"
      IS_LOCAL_DEV: "1"
      DATABASES_STORE_DATABASE_URI: "postgresql://dev:dev@localhost:5432/dust_databases_store"
      CORE_API_KEY: "soupinou"
    shell: "bacon sqlite-worker"
  oauth:
    cwd: "<CONFIG_DIR>/../core"
    shell: "bacon oauth"
  front:
    cwd: "<CONFIG_DIR>/../front"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && ./admin/dev.sh"
  front-workers:
    cwd: "<CONFIG_DIR>/../front"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && ./admin/dev_worker.sh"
  sdks-js:
    cwd: "<CONFIG_DIR>/../sdks/js"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && ./admin/dev.sh"
  connectors:
    cwd: "<CONFIG_DIR>/../connectors"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && ./admin/dev.sh"
  sparkle:
    cwd: "<CONFIG_DIR>/../sparkle"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && npm run storybook"
    autostart: false
  extension:
    cwd: "<CONFIG_DIR>/../extension"
    shell: "source ~/.nvm/nvm.sh && nvm install && npm install && npm run dev:chrome"
    autostart: false