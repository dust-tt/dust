{"code":"// Memoize function with TTL.\n// Usage:\n// const memoizedFn = memoize(fn, (fnArg1, fnArg2, ...) => `${fnArg1}-${fnArg2}`, 60 * 10 * 1000);\n// Cache expires after ttlMs since last usage of the memoized function.\nexport function memoize(fn, resolver, ttlMs) {\n    const cache = new Map();\n    let ttlTimeout = undefined;\n    const extendTTL = () => {\n        clearTimeout(ttlTimeout);\n        ttlTimeout = setTimeout(() => {\n            cache.clear();\n        }, ttlMs);\n    };\n    extendTTL();\n    return function (...args) {\n        extendTTL();\n        const key = resolver(...args);\n        if (cache.has(key)) {\n            const cacheHit = cache.get(key);\n            if (cacheHit) {\n                return cacheHit;\n            }\n            else {\n                throw new Error(`Cache hit but no value - this should never happen. Cache key: ${key}`);\n            }\n        }\n        const result = fn(...args);\n        cache.set(key, result);\n        return result;\n    };\n}\n//# sourceMappingURL=memoize.js.map","references":[],"map":"{\"version\":3,\"file\":\"memoize.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/shared/memoize.ts\"],\"names\":[],\"mappings\":\"AAAA,6BAA6B;AAC7B,SAAS;AACT,kGAAkG;AAClG,uEAAuE;AACvE,MAAM,UAAU,OAAO,CACrB,EAAK,EACL,QAA4C,EAC5C,KAAa;IAEb,MAAM,KAAK,GAAG,IAAI,GAAG,EAAyB,CAAC;IAC/C,IAAI,UAAU,GAA+B,SAAS,CAAC;IAEvD,MAAM,SAAS,GAAG,GAAG,EAAE;QACrB,YAAY,CAAC,UAAU,CAAC,CAAC;QACzB,UAAU,GAAG,UAAU,CAAC,GAAG,EAAE;YAC3B,KAAK,CAAC,KAAK,EAAE,CAAC;QAChB,CAAC,EAAE,KAAK,CAAC,CAAC;IACZ,CAAC,CAAC;IACF,SAAS,EAAE,CAAC;IACZ,OAAO,UAAU,GAAG,IAAmB;QACrC,SAAS,EAAE,CAAC;QAEZ,MAAM,GAAG,GAAG,QAAQ,CAAC,GAAG,IAAI,CAAC,CAAC;QAC9B,IAAI,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAClB,MAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAChC,IAAI,QAAQ,EAAE;gBACZ,OAAO,QAAQ,CAAC;aACjB;iBAAM;gBACL,MAAM,IAAI,KAAK,CACb,iEAAiE,GAAG,EAAE,CACvE,CAAC;aACH;SACF;QACD,MAAM,MAAM,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;QAC3B,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACvB,OAAO,MAAM,CAAC;IAChB,CAAM,CAAC;AACT,CAAC\"}","dtsmap":{"name":"/Users/edouardwautier/Projects/dust/types/node_modules/.cache/rollup-plugin-typescript2/placeholder/shared/memoize.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"memoize.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/shared/memoize.ts\"],\"names\":[],\"mappings\":\"AAIA,wBAAgB,OAAO,CAAC,CAAC,SAAS,CAAC,GAAG,IAAI,EAAE,GAAG,EAAE,KAAK,GAAG,EACvD,EAAE,EAAE,CAAC,EACL,QAAQ,EAAE,CAAC,GAAG,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC,KAAK,MAAM,EAC5C,KAAK,EAAE,MAAM,GACZ,CAAC,CA6BH\"}"},"dts":{"name":"/Users/edouardwautier/Projects/dust/types/node_modules/.cache/rollup-plugin-typescript2/placeholder/shared/memoize.d.ts","writeByteOrderMark":false,"text":"export declare function memoize<T extends (...args: any[]) => any>(fn: T, resolver: (...args: Parameters<T>) => string, ttlMs: number): T;\n//# sourceMappingURL=memoize.d.ts.map"}}
