"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("io-ts"),t=require("fp-ts/lib/Either"),r=require("io-ts-reporters"),n=require("uuid"),o=require("io-ts-types/lib/nonEmptyArray"),s=require("io-ts-types/lib/NonEmptyString"),i=require("eventsource-parser"),a=require("io-ts-types"),u=require("io-ts-types/lib/NumberFromString"),c=require("redis"),p=require("hot-shots"),l=require("child_process"),d=require("fp-ts/Either"),f=require("htmlparser2"),h=require("stream"),m=require("csv-stringify/sync"),_=require("crypto"),g=require("csv-parse"),y=require("csv-stringify");function x(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,t}var v=x(e),I=x(r),E=x(l),S=function(){function e(e){this.value=void 0,this.value=e}var t=e.prototype;return t.isOk=function(){return!0},t.isErr=function(){return!1},e}(),b=function(){function e(e){this.error=void 0,this.error=e}var t=e.prototype;return t.isOk=function(){return!1},t.isErr=function(){return!0},e}();function T(e,t){var r=function(t){return e.includes(t)};return new v.Type(t||n.v4(),r,(function(e,t){return r(e)?v.success(e):v.failure(e,t)}),v.identity)}function w(e,t){return v.brand(v.number,(function(r){return r>=e&&r<=t}),"Range")}var C=v.brand(v.string,(function(e){return/^[a-z0-9_]+$/.test(e)}),"SlugifiedString"),A=new v.Type("NumberAsString",(function(e){return"number"==typeof e}),(function(e,t){return"number"==typeof e?v.success(e.toString()):v.failure(e,t,"Value must be a number")}),v.identity),R=v.type({majorCommand:v.literal("connectors"),command:v.union([v.literal("stop"),v.literal("delete"),v.literal("pause"),v.literal("unpause"),v.literal("resume"),v.literal("full-resync"),v.literal("set-error"),v.literal("clear-error"),v.literal("restart"),v.literal("get-parents"),v.literal("set-permission"),v.literal("garbage-collect")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),k=v.type({majorCommand:v.literal("confluence"),command:v.union([v.literal("me"),v.literal("upsert-page"),v.literal("upsert-pages"),v.literal("update-parents")]),args:v.type({connectorId:v.union([v.number,v.undefined]),pageId:v.union([v.number,v.undefined]),spaceId:v.union([v.number,v.undefined]),file:v.union([v.string,v.undefined]),keyInFile:v.union([v.string,v.undefined])})}),O=v.type({me:v.UnknownRecord}),D=v.type({workflowId:v.string,workflowUrl:v.union([v.string,v.undefined])}),N=v.type({majorCommand:v.literal("github"),command:v.union([v.literal("resync-repo"),v.literal("code-sync"),v.literal("sync-issue"),v.literal("force-daily-code-sync"),v.literal("skip-issue")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),L=v.type({majorCommand:v.literal("notion"),command:v.union([v.literal("skip-page"),v.literal("skip-database"),v.literal("upsert-page"),v.literal("upsert-database"),v.literal("search-pages"),v.literal("update-core-parents"),v.literal("check-url"),v.literal("find-url"),v.literal("delete-url"),v.literal("me"),v.literal("stop-all-garbage-collectors"),v.literal("update-parents-fields"),v.literal("clear-parents-last-updated-at")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),P=v.type({majorCommand:v.literal("google_drive"),command:v.union([v.literal("garbage-collect-all"),v.literal("get-file"),v.literal("check-file"),v.literal("get-google-parents"),v.literal("clean-invalid-parents"),v.literal("upsert-file"),v.literal("update-core-parents"),v.literal("restart-google-webhooks"),v.literal("start-incremental-sync"),v.literal("restart-all-incremental-sync-workflows"),v.literal("skip-file"),v.literal("register-webhook"),v.literal("register-all-webhooks"),v.literal("list-labels")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),U=v.type({majorCommand:v.literal("slack"),command:v.union([v.literal("enable-bot"),v.literal("sync-channel"),v.literal("sync-thread"),v.literal("uninstall-for-unknown-team-ids"),v.literal("whitelist-domains"),v.literal("whitelist-bot"),v.literal("sync-channel-metadata")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),G=v.type({majorCommand:v.literal("batch"),command:v.union([v.literal("full-resync"),v.literal("restart-all"),v.literal("stop-all"),v.literal("resume-all")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),M=v.type({majorCommand:v.literal("webcrawler"),command:v.literal("start-scheduler")}),F=v.type({succeeded:v.number,failed:v.number}),j=v.type({majorCommand:v.literal("temporal"),command:v.union([v.literal("find-unprocessed-workflows"),v.literal("check-queue")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),K=v.type({majorCommand:v.literal("intercom"),command:v.union([v.literal("force-resync-articles"),v.literal("check-conversation"),v.literal("fetch-conversation"),v.literal("fetch-articles"),v.literal("check-missing-conversations"),v.literal("check-teams")]),args:v.type({force:v.union([v.literal("true"),v.undefined]),connectorId:v.union([v.number,v.undefined]),conversationId:v.union([v.number,v.undefined]),day:v.union([v.string,v.undefined]),helpCenterId:v.union([v.number,v.undefined])})}),W=v.type({isConversationOnIntercom:v.boolean,isConversationOnDB:v.boolean,conversationTeamIdOnIntercom:v.union([v.string,v.undefined]),conversationTeamIdOnDB:v.union([v.string,v.undefined,v.null])}),B=v.type({conversation:v.union([v.UnknownRecord,v.null])}),H=v.type({articles:v.array(v.union([v.UnknownRecord,v.null]))}),V=v.type({teams:v.array(v.type({teamId:v.string,name:v.string,isTeamOnDB:v.boolean}))}),q=v.type({missingConversations:v.array(v.type({conversationId:v.string,teamId:v.union([v.number,v.null]),open:v.boolean,createdAt:v.number}))}),z=v.type({affectedCount:v.number}),J=v.type({majorCommand:v.literal("zendesk"),command:v.union([v.literal("check-is-admin"),v.literal("count-tickets"),v.literal("resync-tickets"),v.literal("fetch-ticket"),v.literal("fetch-brand"),v.literal("resync-help-centers"),v.literal("resync-brand-metadata")]),args:v.type({wId:v.union([v.string,v.undefined]),dsId:v.union([v.string,v.undefined]),connectorId:v.union([v.number,v.undefined]),brandId:v.union([v.number,v.undefined]),query:v.union([v.string,v.undefined]),forceResync:v.union([v.literal("true"),v.undefined]),ticketId:v.union([v.number,v.undefined]),ticketUrl:v.union([v.string,v.undefined])})}),Y=v.type({userRole:v.string,userActive:v.boolean,userIsAdmin:v.boolean}),Q=v.type({ticketCount:v.number}),X=v.type({ticket:v.union([v.UnknownRecord,v.null]),isTicketOnDb:v.boolean}),Z=v.type({brand:v.union([v.UnknownRecord,v.null]),brandOnDb:v.union([v.UnknownRecord,v.null])}),$=v.type({majorCommand:v.literal("microsoft"),command:v.union([v.literal("garbage-collect-all"),v.literal("check-file"),v.literal("start-incremental-sync"),v.literal("restart-all-incremental-sync-workflows"),v.literal("skip-file"),v.literal("sync-node"),v.literal("get-parents")]),args:v.record(v.string,v.union([v.string,A,v.undefined]))}),ee=v.union([G,R,k,N,P,K,$,L,U,j,M,J]),te=v.type({success:v.literal(!0)}),re=v.type({status:v.number,type:v.union([v.literal("undefined"),v.literal("object"),v.literal("boolean"),v.literal("number"),v.literal("string"),v.literal("function"),v.literal("symbol"),v.literal("bigint")]),content:v.unknown}),ne=v.type({parents:v.array(v.string)}),oe=v.type({workflowId:v.string,workflowUrl:v.union([v.string,v.undefined])}),se=v.type({pages:v.array(v.type({id:v.string,title:v.union([v.string,v.undefined]),type:v.union([v.literal("page"),v.literal("database")]),isSkipped:v.boolean,isFull:v.boolean}))}),ie=v.type({page:v.union([v.UnknownRecord,v.null]),db:v.union([v.UnknownRecord,v.null])}),ae=v.type({deletedPage:v.boolean,deletedDb:v.boolean}),ue=v.type({page:v.union([v.UnknownRecord,v.null]),db:v.union([v.UnknownRecord,v.null])}),ce=v.type({me:v.UnknownRecord,botOwner:v.UnknownRecord}),pe=v.type({taskQueue:v.UnknownRecord}),le=v.type({queuesAndPollers:v.array(v.type({queue:v.string,pollers:v.number})),unprocessedQueues:v.array(v.string)}),de=v.union([te,F,re,O,D,ne,W,q,V,B,H,ie,ae,ce,se,oe,pe,le,z,Y,Q,X,Z]);function fe(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&"type"in e&&"string"==typeof e.type}var he=v.array(v.type({pattern:v.string,spaceId:v.string})),me=v.type({botEnabled:v.boolean,whitelistedDomains:v.union([v.array(v.string),v.undefined]),autoReadChannelPatterns:he}),_e=[0,1,2,3,4,5],ge=v.type({url:v.string,depth:v.union([v.literal(0),v.literal(1),v.literal(2),v.literal(3),v.literal(4),v.literal(5)]),maxPageToCrawl:v.number,crawlMode:v.union([v.literal("child"),v.literal("website")]),crawlFrequency:v.union([v.literal("never"),v.literal("daily"),v.literal("weekly"),v.literal("monthly")]),headers:v.record(v.string,v.string)}),ye=v.union([ge,me,v.null]),xe=v.type({configuration:ye}),ve=v.type({workspaceAPIKey:v.string,dataSourceId:v.string,workspaceId:v.string,connectionId:v.string,configuration:ye}),Ie=v.type({connectionId:v.string});function Ee(e){var t,r;function n(t,r){try{var s=e[t](r),i=s.value,a=i instanceof Se;Promise.resolve(a?i.v:i).then((function(r){if(a){var u="return"===t?"return":"next";if(!i.k||r.done)return n(u,r);r=e[u](r).value}o(s.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,o){return new Promise((function(s,i){var a={key:e,arg:o,resolve:s,reject:i,next:null};r?r=r.next=a:(t=r=a,n(e,o))}))},"function"!=typeof e.return&&(this.return=void 0)}function Se(e,t){this.v=e,this.k=t}function be(e){var t,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new Te(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Te(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return Te=function(e){this.s=e,this.n=e.next},Te.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Te(e)}function we(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(we=function(){return!!e})()}function Ce(){Ce=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var s=Object.create((t&&t.prototype instanceof g?t:g).prototype),i=new k(n||[]);return o(s,"_invoke",{value:w(e,r,i)}),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",_={};function g(){}function y(){}function x(){}var v={};c(v,i,(function(){return this}));var I=Object.getPrototypeOf,E=I&&I(I(O([])));E&&E!==r&&n.call(E,i)&&(v=E);var S=x.prototype=g.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(o,s,i,a){var u=l(e[o],e,s);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,i,a)}),(function(e){r("throw",e,i,a)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return r("throw",e,i,a)}))}a(u.arg)}var s;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return s=s?s.then(o,o):o()}})}function w(t,r,n){var o=d;return function(s,i){if(o===h)throw Error("Generator is already running");if(o===m){if("throw"===s)throw i;return{value:e,done:!0}}for(n.method=s,n.arg=i;;){var a=n.delegate;if(a){var u=C(a,n);if(u){if(u===_)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var c=l(t,r,n);if("normal"===c.type){if(o=n.done?m:f,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var s=l(o,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,_;var i=s.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:y,configurable:!0}),y.displayName=c(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},b(T.prototype),c(T.prototype,a,(function(){return this})),t.AsyncIterator=T,t.async=function(e,r,n,o,s){void 0===s&&(s=Promise);var i=new T(p(e,r,n,o),s);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(S),c(S,u,"Generator"),c(S,i,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return a.type="throw",a.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var s=this.tryEntries.length-1;s>=0;--s){var i=this.tryEntries[s],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var s=o;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var i=s?s.completion:{};return i.type=e,i.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function Ae(e,t,r,n,o,s,i){try{var a=e[s](i),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,o)}function Re(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var s=e.apply(t,r);function i(e){Ae(s,n,o,i,a,"next",e)}function a(e){Ae(s,n,o,i,a,"throw",e)}i(void 0)}))}}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ke.apply(this,arguments)}function Oe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ne(e,t)}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ne(e,t)}function Le(e){var t="function"==typeof Map?new Map:void 0;return Le=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(we())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&Ne(o,r.prototype),o}(e,arguments,De(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ne(r,e)},Le(e)}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ue(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Ee.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Ee.prototype.next=function(e){return this._invoke("next",e)},Ee.prototype.throw=function(e){return this._invoke("throw",e)},Ee.prototype.return=function(e){return this._invoke("return",e)};var Ge=function(e){function t(t,r){var n;return(n=e.call(this,t)||this).type=void 0,n.status=void 0,n.data=void 0,n.type=r.type,n.status="http_response_error"===r.type?r.status:void 0,n.data=r.data,n}return Oe(t,e),t}(Le(Error)),Me=v.union([v.literal("table"),v.literal("document"),v.literal("all")]);function Fe(e,t){return"google-spreadsheet-"+e+"-sheet-"+t}var je=v.type({id:v.string,url:v.string,title:v.union([v.string,v.undefined]),parentType:v.union([v.literal("database"),v.literal("page"),v.literal("block"),v.literal("workspace")]),parentId:v.string,archived:v.boolean});function Ke(e){return"notion-"+e}var We=["hour","day","week","month","year"],Be=T(We);function He(e){return e.dataSourceView?"webcrawler"===e.dataSourceView.dataSource.connectorProvider?"document":e.dataSourceView.dataSource.connectorProvider||"document":"document"}var Ve=["openai","anthropic","mistral","google_ai_studio","togetherai","deepseek","fireworks"],qe=["low","medium","high"],ze="openai",Je=[ze,"mistral"],Ye=T(Ve),Qe=T(qe),Xe=T(Je);function Ze(e,t){var r;return(null!=(r=e.whiteListedProviders)?r:Ve).includes(t)}var $e,et="gpt-3.5-turbo",tt="gpt-4-turbo",rt="gpt-4o",nt="gpt-4o-2024-08-06",ot="gpt-4o-mini",st="o1",it="o1-mini",at="o3-mini",ut="claude-3-opus-20240229",ct="claude-3-5-sonnet-20240620",pt="claude-3-5-sonnet-20241022",lt="claude-3-7-sonnet-20250219",dt="claude-3-haiku-20240307",ft="claude-3-5-haiku-20241022",ht="claude-2.1",mt="claude-instant-1.2",_t="mistral-large-latest",gt="mistral-medium",yt="mistral-small-latest",xt="codestral-latest",vt="gemini-1.5-pro-latest",It="gemini-1.5-flash-latest",Et="gemini-2.0-flash-exp",St="gemini-2.0-flash-thinking-exp-01-21",bt="gemini-2.0-flash",Tt="gemini-2.0-flash-lite-preview-02-05",wt="gemini-2.0-pro-exp-02-05",Ct="meta-llama/Llama-3.3-70B-Instruct-Turbo",At="Qwen/Qwen2.5-Coder-32B-Instruct",Rt="Qwen/QwQ-32B-Preview",kt="Qwen/Qwen2-72B-Instruct",Ot="deepseek-ai/DeepSeek-V3",Dt="deepseek-ai/DeepSeek-R1",Nt="deepseek-chat",Lt="deepseek-reasoner",Pt="accounts/fireworks/models/deepseek-r1",Ut=[et,tt,rt,nt,ot,st,it,at,ut,ct,pt,lt,dt,ft,ht,mt,_t,gt,yt,xt,vt,It,Et,St,bt,Tt,wt,Ct,At,Rt,kt,Ot,Dt,Nt,Lt,Pt],Gt=T(Ut),Mt="When using tools, generate valid and properly escaped JSON arguments.",Ft={providerId:"openai",modelId:et,displayName:"GPT 3.5 turbo",contextSize:16384,recommendedTopK:16,recommendedExhaustiveTopK:24,largeModel:!1,description:"OpenAI's GPT 3.5 Turbo model, cost-effective and high throughput (16k context).",shortDescription:"OpenAI's fast model.",isLegacy:!1,toolUseMetaPrompt:Mt,generationTokensCount:2048,supportsVision:!1},jt={providerId:"openai",modelId:tt,displayName:"GPT 4 turbo",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's GPT 4 Turbo model for complex tasks (128k context).",shortDescription:"OpenAI's second best model.",isLegacy:!1,toolUseMetaPrompt:Mt,generationTokensCount:2048,supportsVision:!0},Kt={providerId:"openai",modelId:rt,displayName:"GPT 4o",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's GPT 4o model (128k context).",shortDescription:"OpenAI's most advanced model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!0},Wt={providerId:"openai",modelId:nt,displayName:"GPT 4o",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's GPT 4o model (128k context).",shortDescription:"OpenAI's most advanced model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!0},Bt={providerId:"openai",modelId:ot,displayName:"GPT 4o-mini",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's GPT 4o mini model (128k context).",shortDescription:"OpenAI's fast model.",isLegacy:!1,toolUseMetaPrompt:Mt,generationTokensCount:2048,supportsVision:!0},Ht={providerId:"openai",modelId:st,displayName:"o1",contextSize:2e5,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's reasoning model designed to solve hard problems across domains (Limited preview access).",shortDescription:"OpenAI's reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,featureFlag:"openai_o1_feature",customAssistantFeatureFlag:"openai_o1_custom_assistants_feature"},Vt={providerId:"openai",modelId:st,displayName:"o1 (High Reasoning)",contextSize:2e5,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's reasoning model designed to solve hard problems across domains (Limited preview access). High reasoning effort.",shortDescription:"OpenAI's reasoning model (high effort).",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,reasoningEffort:"high",featureFlag:"openai_o1_high_reasoning_feature",customAssistantFeatureFlag:"openai_o1_high_reasoning_custom_assistants_feature"},qt={providerId:"openai",modelId:it,displayName:"o1-mini",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's fast reasoning model particularly good at coding, math, and science.",shortDescription:"OpenAI's fast reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,featureFlag:"openai_o1_mini_feature",customAssistantFeatureFlag:"openai_o1_custom_assistants_feature"},zt={providerId:"openai",modelId:at,displayName:"o3-mini",contextSize:2e5,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's fast reasoning model particularly good at coding, math, and science.",shortDescription:"OpenAI's fast reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},Jt={providerId:"openai",modelId:at,displayName:"o3-mini (High Reasoning)",contextSize:2e5,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"OpenAI's fast reasoning model particularly good at coding, math, and science. High reasoning effort.",shortDescription:"OpenAI's fast reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,reasoningEffort:"high"},Yt={incompleteDelimiterPatterns:[/<\/?[a-zA-Z_]*$/],delimiters:[{openingPattern:"<thinking>",closingPattern:"</thinking>",classification:"chain_of_thought",swallow:!1},{openingPattern:"<search_quality_reflection>",closingPattern:"</search_quality_reflection>",classification:"chain_of_thought",swallow:!1},{openingPattern:"<reflecting>",closingPattern:"</reflecting>",classification:"chain_of_thought",swallow:!1},{openingPattern:"<search_quality_score>",closingPattern:"</search_quality_score>",classification:"chain_of_thought",swallow:!0},{openingPattern:"<result>",closingPattern:"</result>",classification:"tokens",swallow:!1},{openingPattern:"<response>",closingPattern:"</response>",classification:"tokens",swallow:!1}]},Qt="Immediately before using a tool, think for one short bullet point in `<thinking>` tags about how it evaluates against the criteria for a good and bad tool use. After using a tool, think for one short bullet point in `<thinking>` tags to evaluate whether the tools results are enough to answer the user's question. The response to the user must be in `<response>` tags. There must be a single `<response>` after the tools use (if any).",Xt={providerId:"anthropic",modelId:ut,displayName:"Claude 3 Opus",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"Anthropic's Claude 3 Opus model (200k context).",shortDescription:"Anthropic's largest model.",isLegacy:!1,delimitersConfiguration:Yt,generationTokensCount:4096,supportsVision:!0,toolUseMetaPrompt:Qt,tokenCountAdjustment:1.15},Zt={providerId:"anthropic",modelId:ct,displayName:"Claude 3.5 Sonnet",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"Anthropic's latest Claude 3.5 Sonnet model (200k context).",shortDescription:"Anthropic's latest model.",isLegacy:!1,delimitersConfiguration:Yt,generationTokensCount:8192,supportsVision:!0,toolUseMetaPrompt:Qt,tokenCountAdjustment:1.15},$t={providerId:"anthropic",modelId:pt,displayName:"Claude 3.5 Sonnet",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"Anthropic's latest Claude 3.5 Sonnet model (200k context).",shortDescription:"Anthropic's latest model.",isLegacy:!1,delimitersConfiguration:Yt,generationTokensCount:8192,supportsVision:!0,toolUseMetaPrompt:Qt,tokenCountAdjustment:1.15},er={providerId:"anthropic",modelId:lt,displayName:"Claude 3.7 Sonnet",contextSize:2e5,recommendedTopK:16,recommendedExhaustiveTopK:128,largeModel:!0,description:"Anthropic's latest Claude 3.7 Sonnet model (200k context).",shortDescription:"Anthropic's best model.",isLegacy:!1,delimitersConfiguration:Yt,generationTokensCount:64e3,supportsVision:!0,toolUseMetaPrompt:Qt,tokenCountAdjustment:1.15},tr={providerId:"anthropic",modelId:ft,displayName:"Claude 3.5 Haiku",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!1,description:"Anthropic's Claude 3.5 Haiku model, cost effective and high throughput (200k context).",shortDescription:"Anthropic's cost-effective model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,tokenCountAdjustment:1.15},rr={providerId:"anthropic",modelId:dt,displayName:"Claude 3 Haiku",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!1,description:"Anthropic's Claude 3 Haiku model, cost effective and high throughput (200k context).",shortDescription:"Anthropic's cost-effective model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,tokenCountAdjustment:1.15},nr={providerId:"anthropic",modelId:ht,displayName:"Claude 2.1",contextSize:18e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"Anthropic's Claude 2 model (200k context).",shortDescription:"Anthropic's legacy model.",isLegacy:!0,generationTokensCount:2048,supportsVision:!1},or={providerId:"anthropic",modelId:mt,displayName:"Claude Instant 1.2",contextSize:9e4,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!1,description:"Anthropic's low-latency and high throughput model (100k context)",shortDescription:"Anthropic's legacy model.",isLegacy:!0,generationTokensCount:2048,supportsVision:!1},sr={providerId:"mistral",modelId:_t,displayName:"Mistral Large",contextSize:128e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!0,description:"Mistral's `large 2` model (128k context).",shortDescription:"Mistral's large model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},ir={providerId:"mistral",modelId:gt,displayName:"Mistral Medium",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!0,description:"Mistral's `medium` model (32k context).",shortDescription:"Mistral's legacy model.",isLegacy:!0,generationTokensCount:2048,supportsVision:!1},ar={providerId:"mistral",modelId:yt,displayName:"Mistral Small",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!1,description:"Mistral's `small` model (8x7B Instruct, 32k context).",shortDescription:"Mistral's cost-effective model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},ur={providerId:"mistral",modelId:xt,displayName:"Mistral Codestral",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!1,description:"Mistral's `codestral` model, specifically designed and optimized for code generation tasks.",shortDescription:"Mistral's code model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},cr={providerId:"google_ai_studio",modelId:vt,displayName:"Gemini Pro 1.5",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's best model for scaling across a wide range of tasks (1m context).",shortDescription:"Google's large model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},pr={providerId:"google_ai_studio",modelId:It,displayName:"Gemini Flash 1.5",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's lightweight, fast and cost-efficient model (1m context).",shortDescription:"Google's cost-effective model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},lr={providerId:"google_ai_studio",modelId:Et,displayName:"Gemini Flash 2.0",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's lightweight, fast and cost-efficient model (1m context).",shortDescription:"Google's cost-effective model (preview).",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,featureFlag:"google_ai_studio_experimental_models_feature"},dr={providerId:"google_ai_studio",modelId:St,displayName:"Gemini Flash 2.0 Thinking",contextSize:32e3,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's lightweight model optimized for reasoning (1m context).",shortDescription:"Google's reasoning-focused model (preview).",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,featureFlag:"google_ai_studio_experimental_models_feature"},fr={providerId:"google_ai_studio",modelId:bt,displayName:"Gemini Flash 2.0",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's fast large context model (1m context).",shortDescription:"Google's fast model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!0},hr={providerId:"google_ai_studio",modelId:Tt,displayName:"Gemini Flash 2.0 Lite Preview",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's lightweight large context model (1m context).",shortDescription:"Google's lightweight model (preview).",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,featureFlag:"google_ai_studio_experimental_models_feature"},mr={providerId:"google_ai_studio",modelId:wt,displayName:"Gemini Flash 2.0 Pro Preview",contextSize:1e6,recommendedTopK:64,recommendedExhaustiveTopK:128,largeModel:!0,description:"Google's powerful large context model (1m context).",shortDescription:"Google's powerful model (preview).",isLegacy:!1,generationTokensCount:2048,supportsVision:!0,featureFlag:"google_ai_studio_experimental_models_feature"},_r={providerId:"togetherai",modelId:Ct,displayName:"Llama 3.3 70B Instruct Turbo",contextSize:128e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"Meta's fast, powerful and open source model (128k context).",shortDescription:"Meta's open source model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},gr={providerId:"togetherai",modelId:At,displayName:"Qwen 2.5 Coder 32B Instruct",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!1,description:"Alibaba's fast model for coding (32k context).",shortDescription:"Alibaba's fast coding model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},yr={providerId:"togetherai",modelId:Rt,displayName:"Qwen QwQ 32B Preview",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!1,description:"Alibaba's fast reasoning model (32k context).",shortDescription:"Alibaba's fast reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},xr={providerId:"togetherai",modelId:kt,displayName:"Qwen 72B Instruct",contextSize:32e3,recommendedTopK:16,recommendedExhaustiveTopK:56,largeModel:!1,description:"Alibaba's powerful model (32k context).",shortDescription:"Alibaba's powerful model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},vr={providerId:"togetherai",modelId:Ot,displayName:"DeepSeek V3 (TogetherAI)",contextSize:131072,recommendedTopK:32,recommendedExhaustiveTopK:64,largeModel:!0,description:"DeepSeek's best model (v3, 64k context).",shortDescription:"DeepSeek's best model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},Ir={providerId:"togetherai",modelId:Dt,displayName:"DeepSeek R1 (TogetherAI)",contextSize:163840,recommendedTopK:32,recommendedExhaustiveTopK:64,largeModel:!0,description:"DeepSeek R1 (reasoning, 163k context, served via TogetherAI).",shortDescription:"DeepSeek R1 (reasoning model).",isLegacy:!1,generationTokensCount:2048,supportsVision:!1},Er={providerId:"deepseek",modelId:Nt,displayName:"DeepSeek",contextSize:64e3,recommendedTopK:32,recommendedExhaustiveTopK:64,largeModel:!0,description:"DeepSeek's best model (v3, 64k context).",shortDescription:"DeepSeek's best model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,featureFlag:"deepseek_feature"},Sr={providerId:"deepseek",modelId:Lt,displayName:"DeepSeek R1",contextSize:64e3,recommendedTopK:32,recommendedExhaustiveTopK:64,largeModel:!0,description:"DeepSeek's reasoning model (R1, 64k context).",shortDescription:"DeepSeek's reasoning model.",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,featureFlag:"deepseek_feature"},br={providerId:"fireworks",modelId:Pt,displayName:"DeepSeek R1 (Fireworks)",contextSize:164e3,recommendedTopK:32,recommendedExhaustiveTopK:128,largeModel:!0,description:"DeepSeek's reasoning model (164k context, served via Fireworks).",shortDescription:"DeepSeek R1 (reasoning model).",isLegacy:!1,generationTokensCount:2048,supportsVision:!1,delimitersConfiguration:{incompleteDelimiterPatterns:[/<\/?[a-zA-Z_]*$/],delimiters:[{openingPattern:"<think>",closingPattern:"</think>",classification:"chain_of_thought",swallow:!1}]}},Tr=[Ft,jt,Kt,Wt,Bt,Ht,Vt,qt,zt,Jt,Xt,Zt,$t,er,rr,tr,nr,or,sr,ir,ar,ur,cr,pr,lr,dr,fr,hr,mr,_r,gr,yr,xr,vr,Ir,Er,Sr,br];function wr(e){var t=e;return Tr.some((function(e){return e.modelId===t.modelId&&e.providerId===t.providerId}))}exports.GLOBAL_AGENTS_SID=void 0,($e=exports.GLOBAL_AGENTS_SID||(exports.GLOBAL_AGENTS_SID={})).HELPER="helper",$e.DUST="dust",$e.SLACK="slack",$e.GOOGLE_DRIVE="google_drive",$e.NOTION="notion",$e.GITHUB="github",$e.INTERCOM="intercom",$e.GPT35_TURBO="gpt-3.5-turbo",$e.GPT4="gpt-4",$e.O1="o1",$e.O1_MINI="o1-mini",$e.O1_HIGH_REASONING="o1_high",$e.O3_MINI="o3-mini",$e.CLAUDE_3_OPUS="claude-3-opus",$e.CLAUDE_3_SONNET="claude-3-sonnet",$e.CLAUDE_3_HAIKU="claude-3-haiku",$e.CLAUDE_3_7_SONNET="claude-3-7-sonnet",$e.CLAUDE_2="claude-2",$e.CLAUDE_INSTANT="claude-instant-1",$e.MISTRAL_LARGE="mistral-large",$e.MISTRAL_MEDIUM="mistral-medium",$e.MISTRAL_SMALL="mistral",$e.GEMINI_PRO="gemini-pro",$e.DEEPSEEK_R1="deepseek-r1";var Cr=[exports.GLOBAL_AGENTS_SID.DUST,exports.GLOBAL_AGENTS_SID.GPT4,exports.GLOBAL_AGENTS_SID.O3_MINI,exports.GLOBAL_AGENTS_SID.SLACK,exports.GLOBAL_AGENTS_SID.NOTION,exports.GLOBAL_AGENTS_SID.GOOGLE_DRIVE,exports.GLOBAL_AGENTS_SID.GITHUB,exports.GLOBAL_AGENTS_SID.INTERCOM,exports.GLOBAL_AGENTS_SID.CLAUDE_3_OPUS,exports.GLOBAL_AGENTS_SID.CLAUDE_3_SONNET,exports.GLOBAL_AGENTS_SID.CLAUDE_3_HAIKU,exports.GLOBAL_AGENTS_SID.CLAUDE_3_7_SONNET,exports.GLOBAL_AGENTS_SID.CLAUDE_2,exports.GLOBAL_AGENTS_SID.CLAUDE_INSTANT,exports.GLOBAL_AGENTS_SID.MISTRAL_LARGE,exports.GLOBAL_AGENTS_SID.MISTRAL_MEDIUM,exports.GLOBAL_AGENTS_SID.MISTRAL_SMALL,exports.GLOBAL_AGENTS_SID.GEMINI_PRO,exports.GLOBAL_AGENTS_SID.HELPER],Ar=w(0,100),Rr=v.type({view:v.union([v.literal("current_user"),v.literal("list"),v.literal("workspace"),v.literal("published"),v.literal("global"),v.literal("admin_internal"),v.literal("all"),v.undefined]),withUsage:v.union([v.literal("true"),v.literal("false"),v.undefined]),withAuthors:v.union([v.literal("true"),v.literal("false"),v.undefined]),withFeedbacks:v.union([v.literal("true"),v.literal("false"),v.undefined]),limit:v.union([Ar,v.undefined]),sort:v.union([v.literal("priority"),v.literal("alphabetical"),v.undefined])}),kr=v.type({limit:v.union([Ar,v.undefined])}),Or=v.type({view:v.union([v.literal("list"),v.literal("workspace"),v.literal("published"),v.literal("global"),v.literal("admin_internal"),v.literal("manage-assistants-search"),v.literal("all")])}),Dr=v.union([v.type({in:v.array(v.string),not:v.array(v.string)}),v.null]),Nr=v.partial({tags:v.union([v.type({in:v.array(v.string),not:v.array(v.string),mode:v.union([v.literal("custom"),v.literal("auto")])}),v.null])}),Lr=v.intersection([v.type({parents:Dr}),Nr]),Pr=v.type({type:v.literal("retrieval_configuration"),query:v.union([v.literal("auto"),v.literal("none")]),relativeTimeFrame:v.union([v.literal("auto"),v.literal("none"),v.type({duration:v.number,unit:Be})]),topK:v.union([v.number,v.literal("auto")]),dataSources:v.array(v.type({dataSourceViewId:v.string,workspaceId:v.string,filter:Lr}))}),Ur=v.type({type:v.literal("dust_app_run_configuration"),appWorkspaceId:v.string,appId:v.string}),Gr=v.type({type:v.literal("tables_query_configuration"),tables:v.array(v.type({dataSourceViewId:v.string,tableId:v.string,workspaceId:v.string}))}),Mr=v.type({type:v.literal("websearch_configuration")}),Fr=v.type({type:v.literal("browse_configuration")}),jr=v.type({type:v.literal("github_get_pull_request_configuration")}),Kr=v.type({type:v.literal("github_create_issue_configuration")}),Wr=v.type({type:v.literal("reasoning_configuration"),modelId:Gt,providerId:Ye,temperature:v.union([v.number,v.null]),reasoningEffort:v.union([Qe,v.null])}),Br=v.type({type:v.literal("process_configuration"),dataSources:v.array(v.type({dataSourceViewId:v.string,workspaceId:v.string,filter:Lr})),relativeTimeFrame:v.union([v.literal("auto"),v.literal("none"),v.type({duration:v.number,unit:Be})]),schema:v.array(v.type({name:v.string,type:v.union([v.literal("string"),v.literal("number"),v.literal("boolean")]),description:v.string}))}),Hr={name:v.union([v.string,v.null]),description:v.union([v.string,v.null])},Vr=v.type({name:v.string,description:v.union([v.string,v.null])}),qr=v.intersection([v.union([Pr,Ur,Gr,Br,Mr,Fr,jr,Kr,Wr]),Vr]),zr=v.intersection([v.type({modelId:Gt,providerId:Ye,temperature:v.number}),v.partial(Hr),v.partial({reasoningEffort:Qe})]),Jr=new v.Type("SupportedModel",wr,(function(e,t){return wr(e)?v.success(e):v.failure(e,t)}),v.identity),Yr=v.type({assistant:v.type({name:v.string,description:v.string,instructions:v.union([v.string,v.null]),pictureUrl:v.string,status:v.union([v.literal("active"),v.literal("archived"),v.literal("draft")]),scope:v.union([v.literal("workspace"),v.literal("published"),v.literal("private")]),model:v.intersection([zr,Jr]),actions:v.array(qr),templateId:v.union([v.string,v.null,v.undefined]),maxStepsPerRun:v.union([v.number,v.undefined]),visualizationEnabled:v.boolean})});function Qr(e){return e.filter((function(e){return null!=e}))}var Xr=function(e){return Array.from(new Set(e))},Zr="TABLE:",$r={data:52428800,code:52428800,delimited:52428800,image:5242880},en={"image/jpeg":{cat:"image",exts:[".jpg",".jpeg"]},"image/png":{cat:"image",exts:[".png"]},"image/gif":{cat:"image",exts:[".gif"]},"image/webp":{cat:"image",exts:[".webp"]},"text/csv":{cat:"delimited",exts:[".csv"]},"text/comma-separated-values":{cat:"delimited",exts:[".csv"]},"text/tsv":{cat:"delimited",exts:[".tsv"]},"text/tab-separated-values":{cat:"delimited",exts:[".tsv"]},"application/vnd.ms-excel":{cat:"delimited",exts:[".xls"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{cat:"delimited",exts:[".xlsx"]},"application/vnd.dust.section.json":{cat:"data",exts:[".json"]},"text/plain":{cat:"data",exts:[".txt",".log",".cfg",".conf"]},"text/markdown":{cat:"data",exts:[".md",".markdown"]},"text/vnd.dust.attachment.slack.thread":{cat:"data",exts:[".txt"]},"text/calendar":{cat:"data",exts:[".ics"]},"application/json":{cat:"data",exts:[".json"]},"application/msword":{cat:"data",exts:[".doc",".docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{cat:"data",exts:[".doc",".docx"]},"application/vnd.ms-powerpoint":{cat:"data",exts:[".ppt",".pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{cat:"data",exts:[".ppt",".pptx"]},"application/pdf":{cat:"data",exts:[".pdf"]},"text/xml":{cat:"data",exts:[".xml"]},"application/xml":{cat:"data",exts:[".xml"]},"text/html":{cat:"data",exts:[".html",".htm",".xhtml",".xhtml+xml"]},"text/css":{cat:"code",exts:[".css"]},"text/javascript":{cat:"code",exts:[".js",".mjs","*.jsx"]},"text/typescript":{cat:"code",exts:[".ts",".tsx"]},"application/x-sh":{cat:"code",exts:[".sh"]},"text/x-sh":{cat:"code",exts:[".sh"]},"text/x-python":{cat:"code",exts:[".py"]},"text/x-python-script":{cat:"code",exts:[".py"]},"application/x-yaml":{cat:"code",exts:[".yaml",".yml"]},"text/yaml":{cat:"code",exts:[".yaml",".yml"]},"text/vnd.yaml":{cat:"code",exts:[".yaml",".yml"]},"text/x-c":{cat:"code",exts:[".c",".cc",".cpp",".cxx",".dic",".h",".hh"]},"text/x-csharp":{cat:"code",exts:[".cs"]},"text/x-java-source":{cat:"code",exts:[".java"]},"text/x-php":{cat:"code",exts:[".php"]},"text/x-ruby":{cat:"code",exts:[".rb"]},"text/x-sql":{cat:"code",exts:[".sql"]},"text/x-swift":{cat:"code",exts:[".swift"]},"text/x-rust":{cat:"code",exts:[".rs"]},"text/x-go":{cat:"code",exts:[".go"]},"text/x-kotlin":{cat:"code",exts:[".kt",".kts"]},"text/x-scala":{cat:"code",exts:[".scala"]},"text/x-groovy":{cat:"code",exts:[".groovy"]},"text/x-perl":{cat:"code",exts:[".pl",".pm"]},"text/x-perl-script":{cat:"code",exts:[".pl",".pm"]}},tn=Object.keys(en);function rn(e){return!!en[e]}function nn(e){if(rn(e)){var t=en[e];if(t)return t}return null}function on(){return Xr(Qr(Object.entries(en).map((function(e){return"image"!==e[1].cat?e[0]:null}))))}var sn=v.type({content:v.string,mentions:v.array(v.type({configurationId:v.string})),context:v.type({timezone:v.string,profilePictureUrl:v.union([v.string,v.null])})}),an=v.intersection([v.intersection([v.type({title:v.string}),v.partial({url:v.union([v.string,v.null]),supersededContentFragmentId:v.union([v.string,v.null])})]),v.type({fileId:v.string})]),un=v.intersection([v.type({context:v.type({profilePictureUrl:v.union([v.string,v.null])})}),an]),cn=v.type({title:v.union([v.string,v.null]),visibility:v.union([v.literal("unlisted"),v.literal("workspace"),v.literal("deleted"),v.literal("test")]),message:v.union([sn,v.null]),contentFragments:v.array(un)}),pn=v.union([v.type({type:v.literal("name"),inputs:v.type({instructions:v.string,description:v.string})}),v.type({type:v.literal("emoji"),inputs:v.type({instructions:v.string})}),v.type({type:v.literal("instructions"),inputs:v.type({current_instructions:v.string,former_suggestions:v.array(v.string)})}),v.type({type:v.literal("description"),inputs:v.type({instructions:v.string,name:v.string})})]),ln=v.union([v.type({status:v.literal("ok"),suggestions:v.union([v.array(v.string),v.null,v.undefined])}),v.type({status:v.literal("unavailable"),reason:v.union([v.literal("user_not_finished"),v.literal("irrelevant")])})]),dn=v.type({suggestions:v.array(v.type({emoji:v.string,backgroundColor:v.string}))}),fn=v.type({instructions:v.string}),hn=v.type({memberIds:v.array(v.string),isRestricted:v.literal(!0)}),mn=v.type({memberIds:v.null,isRestricted:v.literal(!1)}),_n=v.intersection([v.type({name:v.string}),v.union([hn,mn])]),gn=v.union([hn,mn]),yn=v.type({dataSourceId:v.string,parentsIn:v.array(v.string)}),xn=v.type({name:v.union([v.string,v.undefined]),content:v.union([v.array(yn),v.undefined])}),vn=yn,In=v.type({urls:v.array(v.string),method:v.union([v.literal("sync"),v.literal("delete")])}),En=v.type({syncResults:v.array(v.intersection([v.type({url:v.string,method:v.union([v.literal("sync"),v.literal("delete")]),timestamp:v.number,success:v.boolean}),v.partial({error_message:v.string})]))}),Sn=v.type({sync_type:v.union([v.literal("batch"),v.literal("incremental"),v.undefined])}),bn=v.recursion("Section",(function(){return v.type({prefix:v.union([v.string,v.null]),content:v.union([v.string,v.null]),sections:v.array(bn)})})),Tn=v.type({timestamp:v.union([v.Int,v.undefined,v.null]),tags:v.union([v.array(v.string),v.undefined,v.null]),parent_id:v.union([v.string,v.undefined,v.null]),parents:v.union([v.array(v.string),v.undefined,v.null]),source_url:v.union([v.string,v.undefined,v.null]),upsert_context:v.union([Sn,v.undefined,v.null]),text:v.union([v.string,v.undefined,v.null]),section:v.union([bn,v.undefined,v.null]),light_document_output:v.union([v.boolean,v.undefined]),async:v.union([v.boolean,v.undefined,v.null]),title:v.string,mime_type:v.string}),wn=v.intersection([v.type({name:v.string}),Tn]),Cn=v.type({name:v.string,description:v.string,timestamp:v.union([v.number,v.undefined,v.null]),tags:v.union([v.array(v.string),v.undefined,v.null]),parentId:v.union([v.string,v.undefined,v.null]),parents:v.union([v.array(v.string),v.undefined,v.null]),truncate:v.boolean,async:v.union([v.boolean,v.undefined]),fileId:v.union([v.string,v.undefined]),title:v.string,mimeType:v.string,sourceUrl:v.union([v.string,v.undefined,v.null])}),An=v.union([v.type({parentsToAdd:v.union([v.array(v.string),v.undefined]),parentsToRemove:v.union([v.array(v.string),v.undefined])}),v.type({parentsIn:v.array(v.string)})]),Rn=["managed","folder","website","apps"];function kn(e){return Rn.includes(e)}var On=v.type({requestedUrl:v.string,browsedUrl:v.string,content:v.string,responseCode:v.string,errorMessage:v.string}),Dn=v.type({results:v.array(On)}),Nn=function(){function e(e,t,r){void 0===r&&(r=[]),this.id=void 0,this.type=void 0,this.generatedFiles=void 0,this.id=e,this.type=t,this.generatedFiles=r}return e.prototype.getGeneratedFiles=function(){return this.generatedFiles},e}();function Ln(e){return!!e&&"object"==typeof e&&"type"in e&&"process_configuration"===e.type}function Pn(e){var t=e.output;return"string"==typeof(null==t?void 0:t.query_title)?t.query_title:"query_results"}var Un=v.type({title:v.string,snippet:v.string,link:v.string}),Gn=v.union([v.type({results:v.array(Un)}),v.type({error:v.string,results:v.array(Un)})]),Mn=v.type({title:v.string,snippet:v.string,link:v.string,reference:v.string}),Fn=v.union([v.type({results:v.array(Mn)}),v.type({results:v.array(Mn),error:v.string})]),jn=["pink","rose","red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia"],Kn=["100","200","300","400","500","600","700","800"],Wn=["deterministic","factual","balanced","creative"],Bn=T(Wn,"AssistantCreativityLevel"),Hn=function(e){function t(t){var r;return(r=e.call(this,"Cannot access conversation: "+t)||this).type=void 0,r.type=t,r}return Oe(t,e),t}(Le(Error)),Vn=["CONTENT","DATA","DESIGN","ENGINEERING","FINANCE","HIRING","KNOWLEDGE","MARKETING","OPERATIONS","PRODUCT","PRODUCT_MANAGEMENT","PRODUCTIVITY","SALES","UX_DESIGN","UX_RESEARCH","WRITING"],qn={CONTENT:{label:"Content"},DATA:{label:"Data"},DESIGN:{label:"Design"},ENGINEERING:{label:"Engineering"},FINANCE:{label:"Finance"},HIRING:{label:"Hiring"},KNOWLEDGE:{label:"Knowledge"},MARKETING:{label:"Marketing"},OPERATIONS:{label:"Operations"},PRODUCT:{label:"Product"},PRODUCT_MANAGEMENT:{label:"Product Management"},PRODUCTIVITY:{label:"Productivity"},SALES:{label:"Sales"},UX_DESIGN:{label:"UX Design"},UX_RESEARCH:{label:"UX Research"},WRITING:{label:"Writing"}},zn=v.keyof(ke({},qn)),Jn={DUST_APP_RUN:"Run Dust app",RETRIEVAL_SEARCH:"Search data sources",TABLES_QUERY:"Query tables",PROCESS:"Extract data",WEB_NAVIGATION:"Web navigation"},Yn=T(Object.keys(Jn),"MultiActionPreset"),Qn=v.array(v.type({type:Yn,name:s.NonEmptyString,description:s.NonEmptyString,help:s.NonEmptyString})),Xn=["draft","published","disabled"],Zn=T(Xn,"TemplateVisibility"),$n=v.type({backgroundColor:s.NonEmptyString,description:v.union([v.string,v.undefined]),emoji:s.NonEmptyString,handle:s.NonEmptyString,timeFrameDuration:v.union([v.string,v.undefined]),timeFrameUnit:v.union([Be,v.literal(""),v.undefined]),helpActions:v.union([v.string,v.undefined]),helpInstructions:v.union([v.string,v.undefined]),presetActions:Qn,presetInstructions:v.union([v.string,v.undefined]),presetModelId:v.string,presetTemperature:Bn,tags:o.nonEmptyArray(zn),visibility:Zn});function eo(e){return"object"==typeof e&&null!==e&&"getFile"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId&&"object"==typeof e.params&&null!==e.params&&"string"==typeof e.params.fileId}function to(e){return"object"==typeof e&&null!==e&&"getCodeToExecute"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId}function ro(e){return"object"==typeof e&&null!==e&&"setContentHeight"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId&&"object"==typeof e.params&&null!==e.params&&"number"==typeof e.params.height}function no(e){return"object"==typeof e&&null!==e&&"setErrorMessage"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId}function oo(e){return"object"==typeof e&&null!==e&&"downloadFileRequest"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId&&"object"==typeof e.params&&null!==e.params&&e.params.blob instanceof Blob}function so(e){return"object"==typeof e&&null!==e&&"displayCode"===e.command&&"string"==typeof e.identifier&&"string"==typeof e.messageUniqueId}var io=["confluence","github","google_drive","intercom","notion","slack","microsoft","webcrawler","snowflake","zendesk","bigquery","salesforce","gong"],ao=["regular","global","system"],uo="X-Dust-Group-Ids",co=v.type({run_id:v.string,created:v.Integer,run_type:v.string,config:v.UnknownRecord,status:v.type({run:v.string,blocks:v.array(v.type({block_type:v.string,name:v.string,status:v.string,success_count:v.Integer,error_count:v.Integer}))}),traces:v.UnknownArray,specification_hash:v.string}),po=process.env,lo=po.DUST_MANAGED_ANTHROPIC_API_KEY,fo=void 0===lo?"":lo,ho=po.DUST_MANAGED_AZURE_OPENAI_API_KEY,mo=void 0===ho?"":ho,_o=po.DUST_MANAGED_AZURE_OPENAI_ENDPOINT,go=void 0===_o?"":_o,yo=po.DUST_MANAGED_OPENAI_API_KEY,xo=void 0===yo?"":yo,vo=po.DUST_MANAGED_TEXTSYNTH_API_KEY,Io=void 0===vo?"":vo,Eo=po.DUST_MANAGED_MISTRAL_API_KEY,So=void 0===Eo?"":Eo,bo=po.DUST_MANAGED_GOOGLE_AI_STUDIO_API_KEY,To=void 0===bo?"":bo,wo=po.DUST_MANAGED_SERP_API_KEY,Co=void 0===wo?"":wo,Ao=po.DUST_MANAGED_BROWSERLESS_API_KEY,Ro=void 0===Ao?"":Ao,ko=po.DUST_MANAGED_TOGETHERAI_API_KEY,Oo=void 0===ko?"":ko,Do=po.DUST_MANAGED_DEEPSEEK_API_KEY,No=void 0===Do?"":Do,Lo=po.DUST_MANAGED_FIREWORKS_API_KEY,Po=void 0===Lo?"":Lo,Uo=function(){return{ANTHROPIC_API_KEY:fo,AZURE_OPENAI_API_KEY:mo,AZURE_OPENAI_ENDPOINT:go,MISTRAL_API_KEY:So,OPENAI_API_KEY:xo,TEXTSYNTH_API_KEY:Io,GOOGLE_AI_STUDIO_API_KEY:To,SERP_API_KEY:Co,BROWSERLESS_API_KEY:Ro,TOGETHERAI_API_KEY:Oo,DEEPSEEK_API_KEY:No,FIREWORKS_API_KEY:Po}},Go=["oauth_token_revoked","third_party_internal_error","webcrawling_error","webcrawling_error_empty_content","webcrawling_error_content_too_large","webcrawling_error_blocked","webcrawling_synchronization_limit_reached","remote_database_connection_not_readonly","remote_database_network_error"],Mo=function(){function e(e,t){this._url=void 0,this._secret=void 0,this._logger=void 0,this._url=e.url,this._secret=e.secret,this._logger=t}var t=e.prototype;return t.createConnector=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.provider,n=t.workspaceId,o=t.workspaceAPIKey,s=t.dataSourceId,i=t.connectionId,a=t.configuration,e.next=3,this._fetchWithError(this._url+"/connectors/create/"+encodeURIComponent(r),{method:"POST",headers:this.getDefaultHeaders(),body:JSON.stringify({workspaceId:n,workspaceAPIKey:o,dataSourceId:s,connectionId:i,configuration:a})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateConfiguration=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectorId,n=t.configuration,e.next=3,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(r)+"/configuration",{method:"PATCH",headers:this.getDefaultHeaders(),body:JSON.stringify(n)});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateConnector=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectorId,n=t.connectionId,e.next=3,this._fetchWithError(this._url+"/connectors/update/"+encodeURIComponent(r),{method:"POST",headers:this.getDefaultHeaders(),body:JSON.stringify({connectionId:n})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.stopConnector=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/stop/"+encodeURIComponent(t),{method:"POST",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.pauseConnector=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/pause/"+encodeURIComponent(t),{method:"POST",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.unpauseConnector=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/unpause/"+encodeURIComponent(t),{method:"POST",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.resumeConnector=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/resume/"+encodeURIComponent(t),{method:"POST",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.syncConnector=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/sync/"+encodeURIComponent(t),{method:"POST",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.deleteConnector=function(){var e=Re(Ce().mark((function e(t,r){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!1),e.next=3,this._fetchWithError(this._url+"/connectors/delete/"+encodeURIComponent(t)+"?force="+(r?"true":"false"),{method:"DELETE",headers:this.getDefaultHeaders()});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.getConnectorPermissions=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectorId,n=t.filterPermission,o=t.parentId,i=void 0===(s=t.viewType)?"document":s,a=new URLSearchParams,o&&a.append("parentId",o),n&&a.append("filterPermission",n),u=a.toString(),c=this._url+"/connectors/"+encodeURIComponent(r)+"/permissions?viewType="+i+"&"+u,e.next=8,this._fetchWithError(c,{method:"GET",headers:this.getDefaultHeaders()});case 8:return p=e.sent,e.next=11,this._resultFromResponse(p);case 11:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.setConnectorPermissions=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.info({connectorId:r=t.connectorId,resources:n=t.resources},"Setting connector permissions"),e.next=4,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(r)+"/permissions",{method:"POST",headers:this.getDefaultHeaders(),body:JSON.stringify({resources:n.map((function(e){return{internal_id:e.internalId,permission:e.permission}}))})});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getConnector=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=parseInt(t,10),!isNaN(r)){e.next=4;break}return e.abrupt("return",new b({type:"invalid_request_error",message:"Invalid connector ID"}));case 4:return e.next=6,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(t),{method:"GET",headers:this.getDefaultHeaders()});case 6:return e.abrupt("return",this._resultFromResponse(e.sent));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getConnectorFromDataSource=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(null!=(r=t.connectorId)?r:"")+"?origin="+t.id,{method:"GET",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getConnectors=function(){var e=Re(Ce().mark((function e(t,r){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.length){e.next=2;break}return e.abrupt("return",new S([]));case 2:return e.next=4,this._fetchWithError(this._url+"/connectors?provider="+encodeURIComponent(t)+"&"+r.map((function(e){return"connector_id="+encodeURIComponent(e)})).join("&"),{method:"GET",headers:this.getDefaultHeaders()});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.setConnectorConfig=function(){var e=Re(Ce().mark((function e(t,r,n){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(t)+"/config/"+encodeURIComponent(r),{method:"POST",headers:this.getDefaultHeaders(),body:JSON.stringify({configValue:n})});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.getConnectorConfig=function(){var e=Re(Ce().mark((function e(t,r){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/"+encodeURIComponent(t)+"/config/"+encodeURIComponent(r),{method:"GET",headers:this.getDefaultHeaders()});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.linkSlackChannelsWithAgent=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectorId,n=t.slackChannelInternalIds,o=t.agentConfigurationId,e.next=3,this._fetchWithError(this._url+"/slack/channels/linked_with_agent",{method:"PATCH",headers:this.getDefaultHeaders(),body:JSON.stringify({connector_id:r,agent_configuration_id:o,slack_channel_internal_ids:n})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSlackChannelsLinkedWithAgent=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectorId,e.next=3,this._fetchWithError(this._url+"/slack/channels/linked_with_agent?connector_id="+encodeURIComponent(r),{method:"GET",headers:this.getDefaultHeaders()});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.admin=function(){var e=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/connectors/admin",{method:"POST",headers:this.getDefaultHeaders(),body:JSON.stringify(t)});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDefaultHeaders=function(){return{"Content-Type":"application/json",Authorization:"Bearer "+this._secret}},t._fetchWithError=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),e.prev=1,e.next=4,fetch(t,r);case 4:return e.abrupt("return",new S({response:e.sent,duration:Date.now()-n}));case 8:return e.prev=8,e.t0=e.catch(1),o=Date.now()-n,this._logger.error({url:t,duration:o,connectorsError:s={type:"unexpected_network_error",message:"Unexpected network error from ConnectorsAPI: "+e.t0},error:e.t0},"ConnectorsAPI error"),e.abrupt("return",new b(s));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}(),t._resultFromResponse=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isErr()){e.next=2;break}return e.abrupt("return",t);case 2:if(204!==t.value.response.status){e.next=4;break}return e.abrupt("return",new S(void 0));case 4:return e.next=6,t.value.response.text();case 6:r=e.sent,n=null,e.prev=8,n=JSON.parse(r),e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(8),this._logger.error({connectorsError:o={type:"unexpected_response_format",message:"Unexpected response format from ConnectorsAPI: "+e.t0},parseError:e.t0,rawText:r,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"ConnectorsAPI error"),e.abrupt("return",new b(o));case 17:if(t.value.response.ok){e.next=29;break}if(!fe(i=null==(s=n)?void 0:s.error)){e.next=24;break}return this._logger.error({connectorsError:i,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"ConnectorsAPI error"),e.abrupt("return",new b(i));case 24:return this._logger.error({connectorsError:a={type:"unexpected_error_format",message:"Unexpected error format from ConnectorAPI"},json:n,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"ConnectorsAPI error"),e.abrupt("return",new b(a));case 27:e.next=30;break;case 29:return e.abrupt("return",new S(n));case 30:case"end":return e.stop()}}),e,this,[[8,12]])})));return function(t){return e.apply(this,arguments)}}(),e}();function Fo(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&"code"in e&&"string"==typeof e.code}var jo=v.union([v.literal("nodes_titles"),v.literal("data_source_name"),v.literal("both")]),Ko=v.intersection([v.type({data_source_id:v.string,view_filter:v.array(v.string)}),v.partial({search_scope:jo})]),Wo=v.intersection([v.type({data_source_views:v.array(Ko)}),v.partial({excluded_node_mime_types:v.union([v.readonlyArray(v.string),v.undefined]),node_ids:v.array(v.string),node_types:v.array(v.string),parent_id:v.string,query:v.string})]);function Bo(e){return e.replace(/[-_]/g," ").split(" ").filter((function(e){return"managed"!==e})).map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}var Ho=function(){function e(e,t){this._url=void 0,this._apiKey=void 0,this._url=e.url,this._logger=t,this._apiKey=e.apiKey}var t=e.prototype;return t.createProject=function(){var e=Re(Ce().mark((function e(){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/projects",{method:"POST"});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.deleteProject=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDatasets=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/datasets",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataset=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.datasetName,o=t.datasetHash,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/datasets/"+encodeURIComponent(n)+"/"+encodeURIComponent(o),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createDataset=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.datasetId,o=t.data,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/datasets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_id:n,data:o})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.cloneProject=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/clone",{method:"POST"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createRun=function(){var e=Re(Ce().mark((function e(t,r,n){var o,s,i,a,u,c,p,l,d,f,h,m;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.projectId,s=n.runType,i=n.specification,a=n.specificationHash,u=n.datasetId,c=n.inputs,p=n.config,l=n.credentials,d=n.secrets,f=n.isSystemKey,m=void 0===(h=n.storeBlocksResults)||h,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(o)+"/runs",{method:"POST",headers:{"Content-Type":"application/json","X-Dust-Workspace-Id":t.sId,"X-Dust-Group-Ids":r.map((function(e){return e.sId})).join(","),"X-Dust-IsSystemRun":f?"true":"false"},body:JSON.stringify({run_type:s,specification:i,specification_hash:a,dataset_id:u,inputs:c,config:p,credentials:l,secrets:d,store_blocks_results:m})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.createRunStream=function(){var e=Re(Ce().mark((function e(t,r,n){var o,s,a,u,c,p,l,d,f,h,m,_,g,y,x,v,I,E,b,T,w,C,A=this;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.projectId,s=n.runType,a=n.specification,u=n.specificationHash,c=n.datasetId,p=n.inputs,l=n.config,d=n.credentials,f=n.secrets,h=n.isSystemKey,_=void 0===(m=n.storeBlocksResults)||m,e.next=3,this._fetchWithError(this._url+"/projects/"+o+"/runs/stream",{method:"POST",headers:{"Content-Type":"application/json","X-Dust-Workspace-Id":t.sId,"X-Dust-Group-Ids":r.map((function(e){return e.sId})).join(","),"X-Dust-IsSystemRun":h?"true":"false"},body:JSON.stringify({run_type:s,specification:a,specification_hash:u,dataset_id:c,inputs:p,config:l,credentials:d,secrets:f,store_blocks_results:_})});case 3:if(!(g=e.sent).isErr()){e.next=6;break}return e.abrupt("return",g);case 6:if((y=g.value.response).ok&&y.body){e.next=9;break}return e.abrupt("return",this._resultFromResponse(g));case 9:return x=!1,E=new Promise((function(e,t){v=t,I=e})),b=i.createParser((function(e){if("event"===e.type&&e.data)try{var t,r=JSON.parse(e.data);null!=(t=r.content)&&t.run_id&&!x&&(x=!0,I(r.content.run_id))}catch(e){A._logger.error({error:e},"Failed parsing chunk from Core API")}})),T=y.body.getReader(),w=this._logger,C=function(){var e,t=(e=Ce().mark((function e(){var t,r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;case 1:return e.next=4,new Se(T.read(),0);case 4:if(r=(t=e.sent).value,!t.done){e.next=9;break}return e.abrupt("break",14);case 9:return b.feed((new TextDecoder).decode(r)),e.next=12,r;case 12:e.next=1;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),w.error({error:e.t0,errorStr:JSON.stringify(e.t0),errorSource:"createRunStream"},"Error streaming chunks");case 19:return e.prev=19,x||setImmediate((function(){w.error({projectId:o,runType:s,specificationHash:u},"No run id received"),v(new Error("No run id received"))})),T.releaseLock(),e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[0,16,19,23]])})),function(){return new Ee(e.apply(this,arguments))});return function(){return t.apply(this,arguments)}}(),e.abrupt("return",new S({chunkStream:C(),dustRunId:E}));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.deleteRun=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.runId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/runs/"+encodeURIComponent(n),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRunsBatch=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dustRunIds,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/runs/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({run_ids:n})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRun=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.runId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/runs/"+encodeURIComponent(n),{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRunStatus=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.runId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/runs/"+encodeURIComponent(n)+"/status",{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSpecificationHashes=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/specifications",{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSpecification=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.specificationHash,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/specifications/"+encodeURIComponent(n),{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.saveSpecification=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.specification,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/specifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({specification:n})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRunBlock=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.runId,o=t.blockType,s=t.blockName,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/runs/"+encodeURIComponent(n)+"/blocks/"+encodeURIComponent(o)+"/"+encodeURIComponent(s),{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createDataSource=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.config,o=t.credentials,s=t.name,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:n,credentials:o,name:Bo(s)})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateDataSource=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.name,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Bo(o)})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSource=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n),{headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.deleteDataSource=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.searchDataSource=function(){var e=Re(Ce().mark((function e(t,r,n){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(t)+"/data_sources/"+encodeURIComponent(r)+"/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n.query,top_k:n.topK,filter:n.filter,view_filter:n.view_filter,full_text:n.fullText,credentials:n.credentials,target_document_tokens:n.target_document_tokens})});case 2:return e.abrupt("return",this._resultFromResponse(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.getDataSourceDocuments=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dataSourceId,o=t.documentIds,s=t.projectId,i=t.viewFilter,a=new URLSearchParams,r&&(a.append("limit",String(r.limit)),a.append("offset",String(r.offset))),i&&a.append("view_filter",JSON.stringify(i)),o&&o.length>0&&a.append("document_ids",JSON.stringify(o)),e.next=7,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(s)+"/data_sources/"+encodeURIComponent(n)+"/documents?"+a.toString(),{method:"GET"});case 7:return e.abrupt("return",this._resultFromResponse(e.sent));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.getDataSourceDocument=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dataSourceId,n=t.documentId,o=t.projectId,s=t.versionHash,i=t.viewFilter,a=new URLSearchParams,s&&a.append("version_hash",s),i&&a.append("view_filter",JSON.stringify(i)),u=a.toString(),e.next=7,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(o)+"/data_sources/"+encodeURIComponent(r)+"/documents/"+encodeURIComponent(n)+(u?"?"+u:""),{method:"GET"});case 7:return e.abrupt("return",this._resultFromResponse(e.sent));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceDocumentVersions=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,s=t.latest_hash,i=t.limit,u=void 0===(a=t.offset)?0:a,c=new URLSearchParams({limit:String(void 0===i?10:i),offset:String(u)}),s&&c.append("latest_hash",s),e.next=5,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o)+"/versions?"+c.toString(),{method:"GET"});case 5:return e.abrupt("return",this._resultFromResponse(e.sent));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.upsertDataSourceDocument=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l,d,f,h,m;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,s=t.timestamp,i=t.tags,a=t.parentId,u=t.parents,c=t.sourceUrl,p=t.section,l=t.credentials,f=void 0!==(d=t.lightDocumentOutput)&&d,h=t.title,m=t.mimeType,e.next=3,this._fetchWithError(this._url+"/projects/"+r+"/data_sources/"+encodeURIComponent(n)+"/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({document_id:o,timestamp:s,section:p,tags:i,parent_id:a,parents:u,source_url:c,credentials:l,light_document_output:f,title:h,mime_type:m})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceDocumentBlob=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,e.next=3,this._fetchWithError(this._url+"/projects/"+r+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o)+"/blob",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateDataSourceDocumentTags=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,s=t.addTags,i=t.removeTags,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o)+"/tags",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({add_tags:s,remove_tags:i})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateDataSourceDocumentParents=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,s=t.parentId,i=t.parents,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o)+"/parents",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({parents:i,parent_id:s})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.deleteDataSourceDocument=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.scrubDataSourceDocumentDeletedVersions=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.documentId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/documents/"+encodeURIComponent(o)+"/scrub_deleted_versions",{method:"POST"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.tokenize=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.text,n=t.modelId,o=t.providerId,s=Uo(),e.next=4,this._fetchWithError(this._url+"/tokenize",{method:"POST",headers:{"Content-Type":"application/json"},keepalive:!1,body:JSON.stringify({text:r,model_id:n,provider_id:o,credentials:s})});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.tokenizeBatch=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.texts,n=t.modelId,o=t.providerId,s=Uo(),e.next=4,this._fetchWithError(this._url+"/tokenize/batch",{method:"POST",headers:{"Content-Type":"application/json"},keepalive:!1,body:JSON.stringify({texts:r,model_id:n,provider_id:o,credentials:s})});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.dataSourceTokenize=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.text,n=t.projectId,o=t.dataSourceId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(n)+"/data_sources/"+encodeURIComponent(o)+"/tokenize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.tableValidateCSVContent=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.bucket,s=t.bucketCSVPath,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/validate_csv_content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bucket:o,bucket_csv_path:s})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.upsertTable=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l,d,f,h,m;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.name,i=t.description,a=t.timestamp,u=t.tags,c=t.parentId,p=t.parents,l=t.remoteDatabaseTableId,d=t.remoteDatabaseSecretId,f=t.title,h=t.mimeType,m=t.sourceUrl,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_id:o,name:s,description:i,timestamp:a,tags:u,parent_id:c,parents:p,remote_database_table_id:null!=l?l:null,remote_database_secret_id:null!=d?d:null,title:f,mime_type:h,source_url:m})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTable=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.viewFilter,i=new URLSearchParams,s&&i.append("view_filter",JSON.stringify(s)),e.next=5,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"?"+i.toString(),{method:"GET"});case 5:return e.abrupt("return",this._resultFromResponse(e.sent));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTables=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dataSourceId,o=t.projectId,s=t.tableIds,i=t.viewFilter,a=new URLSearchParams,i&&a.append("view_filter",JSON.stringify(i)),s&&s.length>0&&a.append("table_ids",JSON.stringify(s)),r&&(a.append("limit",String(r.limit)),a.append("offset",String(r.offset))),e.next=7,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(o)+"/data_sources/"+encodeURIComponent(n)+"/tables?"+a.toString(),{method:"GET"});case 7:return e.abrupt("return",this._resultFromResponse(e.sent));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.deleteTable=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.updateTableParents=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.parentId,i=t.parents,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/parents",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({parent_id:s,parents:i})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.upsertTableRows=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.rows,i=t.truncate,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:s,truncate:i||!1})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.tableUpsertCSVContent=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.bucket,i=t.bucketCSVPath,a=t.truncate,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/csv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bucket:s,bucket_csv_path:i,truncate:a||!1})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTableRow=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.rowId,a=(i=t.filter)?"?view_filter="+encodeURIComponent(JSON.stringify(i)):"",e.next=4,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/rows/"+encodeURIComponent(s)+a,{method:"GET"});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTableRows=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.limit,i=t.offset,u=(a=t.filter)?"&view_filter="+encodeURIComponent(JSON.stringify(a)):"",e.next=4,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/rows?limit="+s+"&offset="+i+u,{method:"GET"});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceTableBlob=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,e.next=3,this._fetchWithError(this._url+"/projects/"+r+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/blob",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.deleteTableRow=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.tableId,s=t.rowId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/tables/"+encodeURIComponent(o)+"/rows/"+encodeURIComponent(s),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.queryDatabase=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tables,n=t.query,o=t.filter,e.next=3,this._fetchWithError(this._url+"/query_database",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n,tables:r,filter:o})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceFolders=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,o=t.dataSourceId,s=t.folderIds,i=t.viewFilter,a=new URLSearchParams,r&&(a.append("limit",String(r.limit)),a.append("offset",String(r.offset))),i&&a.append("view_filter",JSON.stringify(i)),s&&s.length>0&&a.append("document_ids",JSON.stringify(s)),e.next=7,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(n)+"/data_sources/"+encodeURIComponent(o)+"/folders?"+a.toString(),{method:"GET"});case 7:return e.abrupt("return",this._resultFromResponse(e.sent));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.searchNodes=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.query,n=t.filter,o=t.options,e.next=3,this._fetchWithError(this._url+"/nodes/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r,filter:n,options:o})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceStats=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/stats",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.searchTags=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.query,n=t.queryType,o=t.limit,s=t.dataSourceViews.map((function(e){var t;return{data_source_id:e.dataSource.dustAPIDataSourceId,view_filter:null!=(t=e.parentsIn)?t:[]}})),e.next=4,this._fetchWithError(this._url+"/tags/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data_source_views:s,query:r,query_type:n,limit:o})});case 4:return e.abrupt("return",this._resultFromResponse(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getDataSourceFolder=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.folderId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/folders/"+encodeURIComponent(o),{method:"GET"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.upsertDataSourceFolder=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.folderId,s=t.timestamp,i=t.parentId,a=t.parents,u=t.title,c=t.mimeType,p=t.sourceUrl,l=t.providerVisibility,e.next=3,this._fetchWithError(this._url+"/projects/"+r+"/data_sources/"+encodeURIComponent(n)+"/folders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder_id:o,timestamp:s,title:u,parent_id:i,parents:a,mime_type:c,source_url:p,provider_visibility:l})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.deleteDataSourceFolder=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,n=t.dataSourceId,o=t.folderId,e.next=3,this._fetchWithError(this._url+"/projects/"+encodeURIComponent(r)+"/data_sources/"+encodeURIComponent(n)+"/folders/"+encodeURIComponent(o),{method:"DELETE"});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._fetchWithError=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),e.prev=1,o=ke({},r),this._apiKey&&(o.headers=ke({},o.headers,{Authorization:"Bearer "+this._apiKey})),e.next=6,fetch(t,o);case 6:return e.abrupt("return",new S({response:e.sent,duration:Date.now()-n}));case 10:return e.prev=10,e.t0=e.catch(1),s=Date.now()-n,this._logger.error({url:t,duration:s,coreError:i={code:"unexpected_network_error",message:"Unexpected network error from CoreAPI: "+e.t0},error:e.t0},"CoreAPI error"),e.abrupt("return",new b(i));case 16:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}(),t._resultFromResponse=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l,d;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isErr()){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,t.value.response.text();case 4:r=e.sent,n=null,e.prev=6,n=JSON.parse(r),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(6),this._logger.error({coreError:o={code:"unexpected_response_format",message:"Unexpected response format from CoreAPI: "+e.t0},parseError:e.t0,rawText:r,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"CoreAPI error"),e.abrupt("return",new b(o));case 15:if(t.value.response.ok){e.next=27;break}if(!Fo(i=null==(s=n)?void 0:s.error)){e.next=22;break}return this._logger.error({coreError:i,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"CoreAPI error"),e.abrupt("return",new b(i));case 22:return this._logger.error({coreError:a={code:"unexpected_error_format",message:"Unexpected error format from CoreAPI"},json:n,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"CoreAPI error"),e.abrupt("return",new b(a));case 25:e.next=41;break;case 27:if(p=null==(u=n)?void 0:u.error,l=null==(c=n)?void 0:c.response,!p||!Fo(p)){e.next=34;break}return this._logger.error({coreError:p,json:n,status:l.value.response.status,url:l.value.response.url,duration:l.value.duration},"CoreAPI error"),e.abrupt("return",new b(p));case 34:if(!l){e.next=38;break}return e.abrupt("return",new S(l));case 38:return this._logger.error({coreError:d={code:"unexpected_response_format",message:"Unexpected response format from CoreAPI"},json:n,status:l.value.response.status,url:l.value.response.url,duration:l.value.duration},"CoreAPI error"),e.abrupt("return",new b(d));case 41:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(t){return e.apply(this,arguments)}}(),e}(),Vo=["apps","data_source_views","data_sources","spaces","workspaces","global"];function qo(e){throw new Error(("object"==typeof e?JSON.stringify(e):e)+" is not of type never. This should never happen.")}var zo=["admin","builder","user","none"],Jo=["admin","builder","user"];function Yo(e){return Object.fromEntries(e.map((function(e){return[e,null]})))}var Qo=v.keyof(Yo(zo)),Xo=v.keyof(Yo(Jo)),Zo="x-api-user-email",$o=v.type({email:a.NonEmptyString,role:Xo}),es=["admin","builder","user"],ts=["day","lifetime"],rs=v.type({code:s.NonEmptyString,name:s.NonEmptyString,isSlackbotAllowed:v.boolean,isSlackAllowed:v.boolean,isNotionAllowed:v.boolean,isGoogleDriveAllowed:v.boolean,isGithubAllowed:v.boolean,isIntercomAllowed:v.boolean,isConfluenceAllowed:v.boolean,isWebCrawlerAllowed:v.boolean,maxMessages:v.union([v.number,u.NumberFromString]),maxMessagesTimeframe:v.keyof({day:null,lifetime:null}),dataSourcesCount:v.union([v.number,u.NumberFromString]),dataSourcesDocumentsCount:v.union([v.number,u.NumberFromString]),dataSourcesDocumentsSizeMb:v.union([v.number,u.NumberFromString]),maxUsers:v.union([v.number,u.NumberFromString]),maxVaults:v.union([v.number,u.NumberFromString])}),ns=v.type({stripeSubscriptionId:s.NonEmptyString,planCode:s.NonEmptyString}),os=["global","system","conversations"],ss=["okta","samlp","waad"];function is(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&"code"in e&&"string"==typeof e.code}var as=function(){function e(e,t){this._logger=void 0,this._url=void 0,this._apiKey=void 0,this._url=e.url,this._logger=t,this._apiKey=e.apiKey}var t=e.prototype;return t.apiUrl=function(){return this._url},t.createConnection=function(){var e=Re(Ce().mark((function e(t){var r,n,o;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.relatedCredential,o={provider:t.provider,metadata:t.metadata},(r=t.migratedCredentials)&&(o.migrated_credentials=r),n&&(o.related_credential=n),e.next=6,this._fetchWithError(this._url+"/connections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 6:return e.abrupt("return",this._resultFromResponse(e.sent));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.finalizeConnection=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.provider,n=t.connectionId,o=t.code,s=t.redirectUri,e.next=3,this._fetchWithError(this._url+"/connections/"+n+"/finalize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:r,code:o,redirect_uri:s})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getAccessToken=function(){var e=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.provider,n=t.connectionId,e.next=3,this._fetchWithError(this._url+"/connections/"+n+"/access_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:r})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.postCredentials=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.provider,n=t.userId,o=t.workspaceId,s=t.credentials,e.next=3,this._fetchWithError(this._url+"/credentials",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:r,metadata:{user_id:n,workspace_id:o},content:s})});case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getCredentials=function(){var e=Re(Ce().mark((function e(t){var r;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.credentialsId,e.next=3,this._fetchWithError(this._url+"/credentials/"+r);case 3:return e.abrupt("return",this._resultFromResponse(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._fetchWithError=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),o=ke({},r),this._apiKey&&(o.headers=ke({},o.headers,{Authorization:"Bearer "+this._apiKey})),e.prev=3,e.next=6,fetch(t,o);case 6:return e.abrupt("return",new S({response:e.sent,duration:Date.now()-n}));case 10:return e.prev=10,e.t0=e.catch(3),s=Date.now()-n,this._logger.error({url:t,duration:s,oAuthError:i={code:"unexpected_network_error",message:"Unexpected network error from OAuthAPI: "+e.t0},error:e.t0},"OAuthAPI error"),e.abrupt("return",new b(i));case 16:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}(),t._resultFromResponse=function(){var e=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l,d;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isErr()){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,t.value.response.text();case 4:r=e.sent,n=null,e.prev=6,n=JSON.parse(r),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(6),this._logger.error({oAuthError:o={code:"unexpected_response_format",message:"Unexpected response format from OAuthAPI: "+e.t0},parseError:e.t0,rawText:r,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"OAuthAPI error"),e.abrupt("return",new b(o));case 15:if(t.value.response.ok){e.next=27;break}if(!is(i=null==(s=n)?void 0:s.error)){e.next=22;break}return this._logger.error({oAuthError:i,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"OAuthAPI error"),e.abrupt("return",new b(i));case 22:return this._logger.error({oAuthError:a={code:"unexpected_error_format",message:"Unexpected error format from OAuthAPI"},json:n,status:t.value.response.status,url:t.value.response.url,duration:t.value.duration},"OAuthAPI error"),e.abrupt("return",new b(a));case 25:e.next=41;break;case 27:if(p=null==(u=n)?void 0:u.error,l=null==(c=n)?void 0:c.response,!p||!is(p)){e.next=34;break}return this._logger.error({oauthError:p,json:n,status:l.value.response.status,url:l.value.response.url,duration:l.value.duration},"OAuthAPI error"),e.abrupt("return",new b(p));case 34:if(!l){e.next=38;break}return e.abrupt("return",new S(l));case 38:return this._logger.error({oAuthError:d={code:"unexpected_response_format",message:"Unexpected response format from OAuthAPI"},json:n,status:l.value.response.status,url:l.value.response.url,duration:l.value.duration},"OAuthAPI error"),e.abrupt("return",new b(d));case 41:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(t){return e.apply(this,arguments)}}(),e}(),us=new Map;function cs(){return(cs=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.config,n=t.logger,o=t.provider,!((i=us.get(s=t.connectionId))&&i.local_expiry>Date.now())){e.next=4;break}return e.abrupt("return",new S(i));case 4:return e.next=6,new as(r,n).getAccessToken({provider:o,connectionId:s});case 6:if(!(a=e.sent).isErr()){e.next=9;break}return e.abrupt("return",a);case 9:return us.set(s,ke({local_expiry:Date.now()+3e5},a.value)),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ps(){return(ps=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.config,n=t.logger,o=t.credentialsId,e.next=3,new as(r,n).getCredentials({credentialsId:o});case 3:if(!(s=e.sent).isErr()){e.next=6;break}return e.abrupt("return",s);case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ls=["connection","labs_transcripts","platform_actions"],ds=["confluence","github","google_drive","intercom","notion","slack","gong","microsoft","zendesk","salesforce"];function fs(e){return ds.includes(e)}function hs(e){var t=e;return"string"==typeof t.connection_id&&"number"==typeof t.created&&fs(t.provider)&&("pending"===t.status||"finalized"===t.status)}var ms=["gong","modjo"],_s=["snowflake","modjo","bigquery","salesforce"],gs=v.type({username:v.string,password:v.string,account:v.string,role:v.string,warehouse:v.string}),ys=v.type({type:v.string,project_id:v.string,private_key_id:v.string,private_key:v.string,client_email:v.string,client_id:v.string,auth_uri:v.string,token_uri:v.string,auth_provider_x509_cert_url:v.string,client_x509_cert_url:v.string,universe_domain:v.string}),xs=v.type({type:v.string,project_id:v.string,private_key_id:v.string,private_key:v.string,client_email:v.string,client_id:v.string,auth_uri:v.string,token_uri:v.string,auth_provider_x509_cert_url:v.string,client_x509_cert_url:v.string,universe_domain:v.string,location:v.string}),vs=v.type({api_key:v.string}),Is=v.type({client_id:v.string,client_secret:v.string});function Es(){return(Es=Re(Ce().mark((function e(t){var r,n,o,s,i;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dustClientFacingUrl,n=t.owner,o=t.provider,s=t.useCase,i=t.extraConfig,e.abrupt("return",new Promise((function(e){var t=r+"/w/"+n.sId+"/oauth/"+o+"/setup?useCase="+s;i&&(t+="&extraConfig="+encodeURIComponent(JSON.stringify(i)));var a=window.open(t),u=!1,c=function t(r){if(r.origin===window.location.origin&&"connection_finalized"===r.data.type){u=!0;var n=r.data.connection;hs(n)?e(new S(n)):e(new b(new Error("Invalid connection data received from auth window"))),window.removeEventListener("message",t),null==a||a.close()}};window.addEventListener("message",c);var p=setInterval((function(){a&&a.closed&&(window.removeEventListener("message",c),clearInterval(p),setTimeout((function(){u||e(new b(new Error("User closed the window before auth completed")))}),100))}),100)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ss=void 0;function bs(){return Ss||(Ss=new p.StatsD),Ss}function Ts(e){return ws.apply(this,arguments)}function ws(){return ws=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.origin,n=t.redisUri,o=bs(),(s=c.createClient({url:n})).on("error",(function(e){return console.log("Redis Client Error",e)})),s.on("connect",(function(){o.increment("redis.connection.count",1,[r])})),s.on("end",(function(){o.decrement("redis.connection.count",1,[r])})),e.next=8,s.connect();case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)}))),ws.apply(this,arguments)}var Cs={};function As(e){return Rs.apply(this,arguments)}function Rs(){return(Rs=Re(Ce().mark((function e(t){return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){Cs[t]?Cs[t].push(e):(Cs[t]=[],e())})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ks(e){if(void 0===Cs[e])throw new Error("Unreachable: unlock called without lock");if(0!==Cs[e].length){var t=Cs[e].pop();if(!t)throw new Error("Unreachable: unlock called without lock");t()}else delete Cs[e]}var Os=process.env,Ds=Os.SLACK_USER_OPERATION_BOT_TOKEN,Ns=Os.NODE_ENV;function Ls(){return(Ls=Re(Ce().mark((function e(t){var r,n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.service,n=t.logger,"production"===Ns){e.next=3;break}return e.abrupt("return");case 3:if(Ds){e.next=6;break}return n.info({},"SLACK_USER_OPERATION_BOT_TOKEN is not set"),e.abrupt("return");case 6:o="unknown";try{o=E.execSync("git rev-parse HEAD").toString().trim()}catch(e){n.error({},"Failed to get commit id")}return s="papertrail: `initdb` has been initiated. Service: `"+r+"`. CommitId: `"+o+"`",e.prev=9,e.next=12,fetch("https://slack.com/api/chat.postMessage",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Ds},body:JSON.stringify({channel:"deployments",text:"",blocks:[{type:"section",text:{type:"mrkdwn",text:s}}],mrkdown:!0})});case 12:return i=e.sent,e.next=15,i.json();case 15:(a=e.sent).ok||n.error({error:a.error},"Failed to send slack message(1)."),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),n.error({error:e.t0},"Failed to send slack message(2).");case 22:case"end":return e.stop()}}),e,null,[[9,19]])})))).apply(this,arguments)}var Ps=["usage_data_api","okta_enterprise_connection","labs_transcripts","labs_transcripts_full_storage","document_tracker","openai_o1_feature","openai_o1_mini_feature","openai_o1_high_reasoning_feature","openai_o1_custom_assistants_feature","openai_o1_high_reasoning_custom_assistants_feature","deepseek_feature","google_ai_studio_experimental_models_feature","index_private_slack_channel","disable_run_logs","labs_trackers","show_debug_tools","labs_github_actions","deepseek_r1_global_agent_feature","salesforce_feature","advanced_notion_management","attach_from_datasources","force_gdrive_labels_scope"];function Us(e){var t=e.provider;return e.resourceTypes.reduce((function(e,r){var n;return ke({},e,((n={})[r]="application/vnd.dust."+t.replace("_","")+"."+r.replace("_","-").toLowerCase(),n))}),{})}var Gs,Ms={CONFLUENCE:Us({provider:"confluence",resourceTypes:["SPACE","PAGE"]}),GITHUB:Us({provider:"github",resourceTypes:["REPOSITORY","CODE_ROOT","CODE_DIRECTORY","CODE_FILE","ISSUES","ISSUE","DISCUSSIONS","DISCUSSION"]}),GOOGLE_DRIVE:Us({provider:"google_drive",resourceTypes:["SHARED_WITH_ME","FOLDER","SPREADSHEET"]}),INTERCOM:Us({provider:"intercom",resourceTypes:["COLLECTION","TEAMS_FOLDER","CONVERSATION","TEAM","ARTICLE","HELP_CENTER"]}),MICROSOFT:Us({provider:"microsoft",resourceTypes:["FOLDER","SPREADSHEET"]}),NOTION:Us({provider:"notion",resourceTypes:["UNKNOWN_FOLDER","SYNCING_FOLDER","DATABASE","PAGE"]}),SLACK:Us({provider:"slack",resourceTypes:["CHANNEL","THREAD","MESSAGES"]}),SNOWFLAKE:Us({provider:"snowflake",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),WEBCRAWLER:Us({provider:"webcrawler",resourceTypes:["FOLDER"]}),ZENDESK:Us({provider:"zendesk",resourceTypes:["BRAND","HELP_CENTER","CATEGORY","ARTICLE","TICKETS","TICKET"]}),BIGQUERY:Us({provider:"bigquery",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),SALESFORCE:Us({provider:"salesforce",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),GONG:Us({provider:"gong",resourceTypes:["TRANSCRIPT","TRANSCRIPT_FOLDER"]})},Fs=function(e){function t(){return e.apply(this,arguments)||this}return Oe(t,e),t}(Le(Error));function js(e){return Ks.apply(this,arguments)}function Ks(){return(Ks=Re(Ce().mark((function e(t){var r,n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.origin,n=t.redisUri||process.env.REDIS_URI){e.next=4;break}throw new Error("REDIS_URI is not defined");case 4:if(Gs){e.next=8;break}return e.next=7,Ts({origin:r,redisUri:n});case 7:Gs=e.sent;case 8:return e.abrupt("return",Gs);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ws="rate_limiter",Bs=function(e){return Ws+":"+e};function Hs(){return Hs=Re(Ce().mark((function e(t){var r,o,s,i,a,u,c,p,l,d,f,h;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,o=t.maxPerTimeframe,s=t.timeframeSeconds,i=t.logger,a=t.redisUri,u=bs(),c=new Date,p=Bs(r),l=[],d=void 0,e.prev=6,e.next=9,js({origin:"rate_limiter",redisUri:a});case 9:return d=e.sent,e.next=12,d.zCount(p,(new Date).getTime()-1e3*s,"+inf");case 12:if(!((f=o-e.sent)>0)){e.next=21;break}return e.next=17,d.zAdd(p,{score:(new Date).getTime(),value:n.v4()});case 17:return e.next=19,d.expire(p,2*s);case 19:e.next=22;break;case 21:u.increment("ratelimiter.exceeded.count",1,l);case 22:return h=(new Date).getTime()-c.getTime(),u.distribution("ratelimiter.latency.distribution",h,l),e.abrupt("return",f>0?f:0);case 27:return e.prev=27,e.t0=e.catch(6),u.increment("ratelimiter.error.count",1,l),i.error({key:r,maxPerTimeframe:o,timeframeSeconds:s,error:e.t0},"RateLimiter error"),e.abrupt("return",1);case 32:case"end":return e.stop()}}),e,null,[[6,27]])}))),Hs.apply(this,arguments)}function Vs(){return Vs=Re(Ce().mark((function e(t){var r,n,o,s;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.redisUri,o=void 0,e.prev=2,e.next=5,js({origin:"rate_limiter",redisUri:n});case 5:return o=e.sent,s=Bs(r),e.next=9,o.expire(s,0);case 9:return e.abrupt("return",new S(e.sent));case 13:return e.prev=13,e.t0=e.catch(2),e.abrupt("return",new b(e.t0));case 16:case"end":return e.stop()}}),e,null,[[2,13]])}))),Vs.apply(this,arguments)}function qs(e,t,r){var n=void 0===r?{}:r,o=n.retries,s=void 0===o?10:o,i=n.delayBetweenRetriesMs,a=void 0===i?1e3:i;if(s<1)throw new Error("retries must be >= 1");return function(){var r=Re(Ce().mark((function r(n){var o,i,u,c;return Ce().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=[],i=Ce().mark((function r(){var i;return Ce().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t(n);case 3:return r.t0=r.sent,r.abrupt("return",{v:r.t0});case 7:return r.prev=7,r.t1=r.catch(0),i=a*Math.pow(c+1,2),e.warn({error:r.t1,attempt:c+1,retries:s,sleepTime:i},"Error while executing retriable function. Retrying..."),r.next=13,new Promise((function(e){return setTimeout(e,i)}));case 13:o.push(r.t1);case 14:case"end":return r.stop()}}),r,null,[[0,7]])})),c=0;case 3:if(!(c<s)){r.next=11;break}return r.delegateYield(i(),"t0",5);case 5:if(!(u=r.t0)){r.next=8;break}return r.abrupt("return",u.v);case 8:c++,r.next=3;break;case 11:throw new Error(o.join("\n"));case 12:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}function zs(e){return e.prefix+": "+e.pageNumber}function Js(e,t,r){var n={insidePage:!1,pageDepth:0,pageNumber:0,currentPageBuffer:""},o=new f.Parser({onopentag:function(e,t){"div"===e&&t.class===r?n.insidePage?n.pageDepth++:(n.insidePage=!0,n.pageDepth=1):n.insidePage&&n.pageDepth++},ontext:function(e){n.insidePage&&(n.currentPageBuffer+=e.replace("&#13;","").trim()+" ")},onclosetag:function(){n.insidePage&&(n.pageDepth--,0===n.pageDepth&&(n.insidePage=!1,n.currentPageBuffer.trim()&&s.push("\n"+zs({pageNumber:n.pageNumber,prefix:t})+"\n"+n.currentPageBuffer.trim()+"\n"),n.pageNumber++,n.currentPageBuffer=""))},onerror:function(e){s.destroy(e)}},{decodeEntities:!0}),s=new h.Transform({objectMode:!0,transform:function(e,t,r){try{o.write(e.toString()),r()}catch(e){e instanceof Error?r(e):r(new Error("string"==typeof e?e:"Unknown error in htmlParsingTransform.transform()"))}},flush:function(e){try{o.end(),n.insidePage&&n.currentPageBuffer.trim()&&this.push("\n"+zs({pageNumber:n.pageNumber,prefix:t})+"\n"+n.currentPageBuffer.trim()+"\n"),e()}catch(t){t instanceof Error?e(t):e(new Error("string"==typeof t?t:"Unknown error in htmlParsingTransform.flush()"))}}});return e.on("error",(function(e){return s.destroy(e)})),s.on("error",(function(t){return e.destroy(t)})),e.pipe(s)}function Ys(e,t){var r={tags:[],currentRow:[]},n=new f.Parser({onopentag:function(e){r.tags.push(e)},ontext:function(e){var n=r.tags[r.tags.length-1];n===t?o.push(""+Zr+e+"\n"):"td"===n&&r.currentRow.push(e)},onclosetag:function(e){var t=r.tags.pop();if(e!==t)throw new Error("Invalid tag order");if("tr"===t){var n=m.stringify([r.currentRow]);o.push(n),r.currentRow=[]}},onerror:function(e){o.destroy(e)}},{decodeEntities:!0}),o=new h.Transform({objectMode:!0,transform:function(e,t,r){try{n.write(e.toString()),r()}catch(e){e instanceof Error?r(e):r(new Error("string"==typeof e?e:"Unknown error in htmlParsingTransform.transform()"))}},flush:function(e){try{n.end(),e()}catch(t){t instanceof Error?e(t):e(new Error("string"==typeof t?t:"Unknown error in htmlParsingTransform.flush()"))}}});return e.on("error",(function(e){return o.destroy(e)})),o.on("error",(function(t){return e.destroy(t)})),e.pipe(o)}var Qs=v.type({"Content-Type":v.string,"X-TIKA:content":v.string}),Xs={"application/pdf":"$pdfPage","application/vnd.openxmlformats-officedocument.presentationml.presentation":"$slideNumber"},Zs=["application/pdf","application/msword","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"],$s={"application/pdf":{handler:"html",selector:"page",transformer:"document"},"application/vnd.ms-powerpoint":{handler:"html",selector:"slide-content",transformer:"document"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{handler:"html",selector:"slide-content",transformer:"document"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{handler:"html",selector:"h1",transformer:"csv"},"application/vnd.ms-excel":{handler:"html",selector:"h1",transformer:"csv"}},ei=function(){function e(e,t){this.url=void 0,this.options=void 0,this.url=e,this.options=t}var t=e.prototype;return t.getAdditionalHeaders=function(){return{"X-Tika-PDFOcrStrategy":this.options.enableOcr?"auto":"no_ocr","X-Tika-Timeout-Millis":6e4.toString()}},t.fromBuffer=function(){var e=Re(Ce().mark((function e(t,r){var n;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryTika(t,r);case 2:if(!(n=e.sent).isErr()){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",this.processResponse(n.value));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.fromStream=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qs(this.options.logger,(function(e){var t=e.fileStream;return fetch(e.url+"/tika/",{method:"PUT",headers:ke({"Content-Type":e.contentType},e.additionalHeaders),body:h.Readable.toWeb(t),duplex:"half"})}),{retries:3,delayBetweenRetriesMs:1e3})({url:this.url,additionalHeaders:this.getAdditionalHeaders(),contentType:r,fileStream:t});case 2:if((n=e.sent).body){e.next=5;break}throw new Error("Response body is null");case 5:if(o=h.Readable.fromWeb(n.body),!(s=$s[r])){e.next=16;break}a=s.selector,e.t0=i=s.transformer,e.next="document"===e.t0?12:"csv"===e.t0?14:15;break;case 12:return e.abrupt("return",Js(o,Xs[r],a));case 14:return e.abrupt("return",Ys(o,a));case 15:qo(i);case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.queryTika=function(){var e=Re(Ce().mark((function e(t,r){var n,o,s,i,a,u,c;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null!=(n=null==(o=$s[r])?void 0:o.handler)?n:"text",e.prev=1,e.next=4,qs(this.options.logger,(function(e){var t=e.fileBuffer;return fetch(e.url+"/tika/"+e.handlerType,{method:"PUT",headers:ke({Accept:"application/json","Content-Type":e.contentType},e.additionalHeaders),body:t})}),{retries:3,delayBetweenRetriesMs:1e3})({url:this.url,additionalHeaders:this.getAdditionalHeaders(),handlerType:s,contentType:r,fileBuffer:t});case 4:if((i=e.sent).ok){e.next=7;break}return e.abrupt("return",new b(new Error("HTTP error status: "+i.status)));case 7:return e.next=9,i.json();case 9:if(a=Qs.decode(e.sent),!d.isLeft(a)){e.next=14;break}return u=I.formatValidationErrors(a.left),e.abrupt("return",new b(new Error("Invalid response format: "+u)));case 14:return e.abrupt("return",new S(a.right));case 17:return e.prev=17,e.t0=e.catch(1),this.options.logger.error({error:e.t0},"Error while extracting text"),c=e.t0 instanceof Error?e.t0.message:"Unexpected error",e.abrupt("return",new b(new Error("Failed extracting text: "+c)));case 22:case"end":return e.stop()}}),e,this,[[1,17]])})));return function(t,r){return e.apply(this,arguments)}}(),t.processResponse=function(e){var t,r=null==(t=$s[e["Content-Type"]])?void 0:t.selector;return r?this.processContentBySelector(e,r):this.processDefaultResponse(e)},t.processContentBySelector=function(e,t){var r=h.Readable.from(e["X-TIKA:content"]);return new Promise((function(e){var n=[],o="",s=!1,i=0,a=0,u=new f.Parser({onopentag:function(e,r){"div"===e&&r.class===t?(s=!0,i++,o="",a=1):s&&a++},ontext:function(e){s&&(o+=e.trim()+" ")},onclosetag:function(){s&&0==--a&&(s=!1,o.trim()&&n.push({pageNumber:i,content:o.trim()}),o="")},onerror:function(t){return e(new b(t))}},{decodeEntities:!0});r.on("data",(function(e){u.write(e.toString())})),r.on("end",(function(){return u.end(),e(new S(n))})),r.on("error",(function(t){return e(new b(t))}))}))},t.processDefaultResponse=function(e){return Promise.resolve(new S([{pageNumber:1,content:e["X-TIKA:content"].trim()}]))},e}();function ti(){return ti=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.message,n=t.logger,o=t.channel,s=process.env,a=s.SLACK_USER_OPERATION_CHANNEL_ID,(i=s.SLACK_USER_OPERATION_BOT_TOKEN)&&a){e.next=5;break}return n.info({},"SLACK_USER_OPERATION_BOT_TOKEN or SLACK_USER_OPERATION_CHANNEL_ID is not set"),e.abrupt("return");case 5:return e.prev=5,e.next=8,fetch("https://slack.com/api/chat.postMessage",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify({channel:null!=o?o:a,text:r})});case 8:return u=e.sent,e.next=11,u.json();case 11:(c=e.sent).ok||n.error({error:c.error},"Failed to send slack message to user operation channel (1)."),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),n.error({error:e.t0},"Failed to send slack message to user operation channel (2).");case 18:case"end":return e.stop()}}),e,null,[[5,15]])}))),ti.apply(this,arguments)}function ri(){return ri=Re(Ce().mark((function e(t,r,n){var o,s,i,a,u,c;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){return(c=Re(Ce().mark((function e(){var t;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.shift())){e.next=7;break}return e.next=3,r(t.item,t.index);case 3:i[t.index]=e.sent,e.next=0;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},u=function(){return c.apply(this,arguments)},s=void 0===(o=n.concurrency)?8:o,i=new Array(t.length),a=t.map((function(e,t){return{item:e,index:t}})),e.next=7,Promise.all(Array.from({length:Math.min(s,t.length)},(function(){return u()})));case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),ri.apply(this,arguments)}var ni=function(){function e(){}return e.getEnvVariable=function(e){var t=this.cache[e];if(!t){var r=process.env[e];if(void 0===r)throw new Error(e+" is required but not set");return this.cache[e]=r,r}return t},e.getOptionalEnvVariable=function(e){if(!this.cache[e]){var t=process.env[e];t&&(this.cache[e]=t)}return this.cache[e]},e}();function oi(e){return e instanceof Error?e.message:"string"==typeof e?e:JSON.stringify(e)}ni.cache={};var si=!1;function ii(e){return _.createHash("md5").update(e).digest("hex")}function ai(e,t){void 0===t&&(t=32);var r=process.env.DUST_DEVELOPERS_SECRETS_SECRET;return _.createHash("sha256").update(r+e).digest("base64").substring(0,t)}function ui(e){return e>=55296&&e<=56319}function ci(e){return e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/([a-z])([A-Z0-9])/g,"$1_$2").toLowerCase().trim().replace(/\s+/g,"_").replace(/[\W]+/g,"_").replace(/__+/g,"_")}var pi=function(e){function t(){return e.apply(this,arguments)||this}return Oe(t,e),t}(Le(Error)),li=function(e){function t(){return e.apply(this,arguments)||this}return Oe(t,e),t}(Le(Error));function di(e){return fi.apply(this,arguments)}function fi(){return(fi=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c,p,l,d,f,h,m;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=void 0,n=0,o=0,s=[",",";","\t"];case 3:if(!(o<s.length)){e.next=50;break}i=s[o],a=[],e.prev=6,u=g.parse(t,{delimiter:i,to:8,skipEmptyLines:!0}),c=!1,p=!1,e.prev=10,d=be(u);case 12:return e.next=14,d.next();case 14:if(!(c=!(f=e.sent).done)){e.next=22;break}if(a.push(f.value),2!==a.length){e.next=19;break}return e.abrupt("break",22);case 19:c=!1,e.next=12;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),p=!0,l=e.t0;case 28:if(e.prev=28,e.prev=29,!c||null==d.return){e.next=33;break}return e.next=33,d.return();case 33:if(e.prev=33,!p){e.next=36;break}throw l;case 36:return e.finish(33);case 37:return e.finish(28);case 38:e.next=43;break;case 40:return e.prev=40,e.t1=e.catch(6),e.abrupt("continue",47);case 43:if(h=a[0],m=a[1]){e.next=46;break}return e.abrupt("continue",47);case 46:h.length&&h.length===m.length&&h.length>n&&(n=h.length,r=i);case 47:o++,e.next=3;break;case 50:return e.abrupt("return",r);case 51:case"end":return e.stop()}}),e,null,[[6,40],[10,24,28,38],[29,,33,37]])})))).apply(this,arguments)}function hi(){return(hi=Re(Ce().mark((function e(t){var r,n,o,s,i,a,u,c;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,di(t);case 2:r=e.sent,n=[],e.prev=4,o=g.parse(t,{delimiter:r,skipEmptyLines:!0,columns:function(e){return e}}),s=!1,i=!1,e.prev=8,u=be(o);case 10:return e.next=12,u.next();case 12:if(!(s=!(c=e.sent).done)){e.next=18;break}n.push(c.value);case 15:s=!1,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),i=!0,a=e.t0;case 24:if(e.prev=24,e.prev=25,!s||null==u.return){e.next=29;break}return e.next=29,u.return();case 29:if(e.prev=29,!i){e.next=32;break}throw a;case 32:return e.finish(29);case 33:return e.finish(24);case 34:e.next=39;break;case 36:throw e.prev=36,e.t1=e.catch(4),new li(e.t1 instanceof g.CsvError?"Unable to parse CSV string : "+e.t1.message:"Unable to parse CSV string");case 39:return e.abrupt("return",new Promise((function(e,t){y.stringify(n,{header:!0},(function(r,n){r?t(new li("Unable to stringify parsed CSV data")):e(n)}))})));case 40:case"end":return e.stop()}}),e,null,[[4,36],[8,20,24,34],[25,,29,33]])})))).apply(this,arguments)}exports.ACTION_RUNNING_LABELS={browse_action:"Browsing page",conversation_include_file_action:"Reading file",conversation_list_files_action:"Listing files",dust_app_run_action:"Running App",github_create_issue_action:"Creating issue",github_get_pull_request_action:"Retrieving pull request",process_action:"Extracting data",reasoning_action:"Reasoning",retrieval_action:"Searching data",search_labels_action:"Searching labels",tables_query_action:"Querying tables",websearch_action:"Searching the web"},exports.ACTIVE_ROLES=Jo,exports.AGENT_CONFIGURATION_SCOPES=["global","workspace","published","private"],exports.APP_NAME_REGEXP=/^[a-zA-Z0-9_-]{1,64}$/,exports.ASSISTANT_BUILDER_DRAWER_TABS=["Template","Preview","Performance"],exports.ASSISTANT_CREATIVITY_LEVELS=Wn,exports.ASSISTANT_CREATIVITY_LEVEL_DISPLAY_NAMES={deterministic:"Deterministic",factual:"Factual",balanced:"Balanced",creative:"Creative"},exports.ASSISTANT_CREATIVITY_LEVEL_TEMPERATURES={deterministic:0,factual:.2,balanced:.7,creative:1},exports.ActionResponseBaseSchema=co,exports.ActiveRoleSchema=Xo,exports.AdminCommandSchema=ee,exports.AdminResponseSchema=de,exports.AdminSuccessResponseSchema=te,exports.ApiKeyCredentialsSchema=vs,exports.AssistantCreativityLevelCodec=Bn,exports.BaseAction=Nn,exports.BatchAllResponseSchema=F,exports.BatchCommandSchema=G,exports.BigQueryCredentialsWithLocationSchema=xs,exports.BrowseActionOutputSchema=Dn,exports.BrowseResultSchema=On,exports.BuilderEmojiSuggestionsResponseBodySchema=dn,exports.BuilderSuggestionsResponseBodySchema=ln,exports.CLAUDE_2_1_MODEL_ID=ht,exports.CLAUDE_2_DEFAULT_MODEL_CONFIG=nr,exports.CLAUDE_3_5_HAIKU_20241022_MODEL_ID=ft,exports.CLAUDE_3_5_HAIKU_DEFAULT_MODEL_CONFIG=tr,exports.CLAUDE_3_5_SONNET_20240620_DEPRECATED_MODEL_CONFIG=Zt,exports.CLAUDE_3_5_SONNET_20240620_MODEL_ID=ct,exports.CLAUDE_3_5_SONNET_20241022_MODEL_ID=pt,exports.CLAUDE_3_5_SONNET_DEFAULT_MODEL_CONFIG=$t,exports.CLAUDE_3_7_SONNET_20250219_MODEL_ID=lt,exports.CLAUDE_3_7_SONNET_DEFAULT_MODEL_CONFIG=er,exports.CLAUDE_3_HAIKU_20240307_MODEL_ID=dt,exports.CLAUDE_3_HAIKU_DEFAULT_MODEL_CONFIG=rr,exports.CLAUDE_3_OPUS_2024029_MODEL_ID=ut,exports.CLAUDE_3_OPUS_DEFAULT_MODEL_CONFIG=Xt,exports.CLAUDE_INSTANT_1_2_MODEL_ID=mt,exports.CLAUDE_INSTANT_DEFAULT_MODEL_CONFIG=or,exports.CONNECTORS_ERROR_TYPES=Go,exports.CONNECTOR_PROVIDERS=io,exports.CREDENTIALS_PROVIDERS=_s,exports.CheckBigQueryCredentialsSchema=ys,exports.CheckFileGenericResponseSchema=re,exports.ConfluenceClientError=Ge,exports.ConfluenceCommandSchema=k,exports.ConfluenceMeResponseSchema=O,exports.ConfluenceUpsertPageResponseSchema=D,exports.ConnectorConfigurationTypeSchema=ye,exports.ConnectorCreateRequestBodySchema=ve,exports.ConnectorsAPI=Mo,exports.ConnectorsCommandSchema=R,exports.ContentNodesViewTypeCodec=Me,exports.ContentSchema=yn,exports.ConversationError=Hn,exports.CoreAPI=Ho,exports.CoreAPIDatasourceViewFilterSchema=Ko,exports.CoreAPINodesSearchFilterSchema=Wo,exports.CoreAPISearchScopeSchema=jo,exports.CrawlingFrequencies=["never","daily","weekly","monthly"],exports.CrawlingModes=["child","website"],exports.CreatePlanFormSchema=rs,exports.CreateTemplateFormSchema=$n,exports.DATA_SOURCE_VIEW_CATEGORIES=Rn,exports.DEEPSEEK_CHAT_MODEL_CONFIG=Er,exports.DEEPSEEK_CHAT_MODEL_ID=Nt,exports.DEEPSEEK_REASONER_MODEL_CONFIG=Sr,exports.DEEPSEEK_REASONER_MODEL_ID=Lt,exports.DEFAULT_EMBEDDING_PROVIDER_ID=ze,exports.DEFAULT_MAX_STEPS_USE_PER_RUN=8,exports.DEFAULT_QDRANT_CLUSTER="cluster-0",exports.DEPTH_DISPLAY_TEXT={0:"0 level",1:"1 level",2:"2 levels",3:"3 levels",4:"4 levels",5:"5 levels"},exports.DepthOptions=_e,exports.EMBEDDING_CONFIGS={openai:{model_id:"text-embedding-3-large-1536",provider_id:"openai",splitter_id:"base_v0",max_chunk_size:512},mistral:{model_id:"mistral-embed",provider_id:"mistral",splitter_id:"base_v0",max_chunk_size:512}},exports.EMBEDDING_PROVIDER_IDS=Je,exports.EXCLUDE_DATABASES=["SNOWFLAKE","SNOWFLAKE_SAMPLE_DATA"],exports.EXCLUDE_SCHEMAS=["INFORMATION_SCHEMA"],exports.EmbeddingProviderCodec=Xe,exports.EnterpriseUpgradeFormSchema=ns,exports.EnvironmentConfig=ni,exports.Err=b,exports.FIREWORKS_DEEPSEEK_R1_MODEL_CONFIG=br,exports.FIREWORKS_DEEPSEEK_R1_MODEL_ID=Pt,exports.FREQUENCY_DISPLAY_TEXT={never:"Never",daily:"Every day",weekly:"Every week",monthly:"Every month"},exports.FrontDataSourceDocumentSection=bn,exports.GEMINI_1_5_FLASH_LATEST_MODEL_ID=It,exports.GEMINI_1_5_PRO_LATEST_MODEL_ID=vt,exports.GEMINI_2_FLASH_LITE_PREVIEW_MODEL_CONFIG=hr,exports.GEMINI_2_FLASH_LITE_PREVIEW_MODEL_ID=Tt,exports.GEMINI_2_FLASH_MODEL_CONFIG=fr,exports.GEMINI_2_FLASH_MODEL_ID=bt,exports.GEMINI_2_FLASH_PREVIEW_MODEL_CONFIG=lr,exports.GEMINI_2_FLASH_PREVIEW_MODEL_ID=Et,exports.GEMINI_2_FLASH_THINKING_PREVIEW_MODEL_CONFIG=dr,exports.GEMINI_2_FLASH_THINKING_PREVIEW_MODEL_ID=St,exports.GEMINI_2_PRO_PREVIEW_MODEL_CONFIG=mr,exports.GEMINI_2_PRO_PREVIEW_MODEL_ID=wt,exports.GEMINI_FLASH_DEFAULT_MODEL_CONFIG=pr,exports.GEMINI_PRO_DEFAULT_MODEL_CONFIG=cr,exports.GPT_3_5_TURBO_MODEL_CONFIG=Ft,exports.GPT_3_5_TURBO_MODEL_ID=et,exports.GPT_4O_20240806_MODEL_CONFIG=Wt,exports.GPT_4O_20240806_MODEL_ID=nt,exports.GPT_4O_MINI_MODEL_CONFIG=Bt,exports.GPT_4O_MINI_MODEL_ID=ot,exports.GPT_4O_MODEL_CONFIG=Kt,exports.GPT_4O_MODEL_ID=rt,exports.GPT_4_TURBO_MODEL_CONFIG=jt,exports.GPT_4_TURBO_MODEL_ID=tt,exports.GROUP_KINDS=ao,exports.GetAgentConfigurationsHistoryQuerySchema=kr,exports.GetAgentConfigurationsLeaderboardQuerySchema=Or,exports.GetAgentConfigurationsQuerySchema=Rr,exports.GetParentsResponseSchema=ne,exports.GetPostNotionSyncResponseBodySchema=En,exports.GithubCommandSchema=N,exports.GoogleDriveCommandSchema=P,exports.IntercomCheckConversationResponseSchema=W,exports.IntercomCheckMissingConversationsResponseSchema=q,exports.IntercomCheckTeamsResponseSchema=V,exports.IntercomCommandSchema=K,exports.IntercomFetchArticlesResponseSchema=H,exports.IntercomFetchConversationResponseSchema=B,exports.IntercomForceResyncArticlesResponseSchema=z,exports.InternalPostBuilderProcessActionGenerateSchemaRequestBodySchema=fn,exports.InternalPostBuilderSuggestionsRequestBodySchema=pn,exports.InternalPostContentFragmentRequestBodySchema=un,exports.InternalPostConversationsRequestBodySchema=cn,exports.InternalPostMessagesRequestBodySchema=sn,exports.InvalidStructuredDataHeaderError=pi,exports.InviteMemberFormSchema=$o,exports.MAX_CHUNK_SIZE=512,exports.MAX_FILE_SIZES=$r,exports.MAX_MESSAGE_TIMEFRAMES=ts,exports.MAX_STEPS_USE_PER_RUN_LIMIT=12,exports.MEMBERSHIP_ROLE_TYPES=es,exports.MIME_TYPES=Ms,exports.MIN_SEARCH_QUERY_SIZE=2,exports.MISTRAL_CODESTRAL_MODEL_CONFIG=ur,exports.MISTRAL_CODESTRAL_MODEL_ID=xt,exports.MISTRAL_LARGE_MODEL_CONFIG=sr,exports.MISTRAL_LARGE_MODEL_ID=_t,exports.MISTRAL_MEDIUM_MODEL_CONFIG=ir,exports.MISTRAL_MEDIUM_MODEL_ID=gt,exports.MISTRAL_SMALL_MODEL_CONFIG=ar,exports.MISTRAL_SMALL_MODEL_ID=yt,exports.MODEL_IDS=Ut,exports.MODEL_PROVIDER_IDS=Ve,exports.MULTI_ACTION_PRESETS=Jn,exports.MicrosoftCommandSchema=$,exports.ModelIdCodec=Gt,exports.ModelProviderIdCodec=Ye,exports.MultiActionPresetCodec=Yn,exports.NotionCheckUrlResponseSchema=ie,exports.NotionCommandSchema=L,exports.NotionDeleteUrlResponseSchema=ae,exports.NotionFindUrlResponseSchema=ue,exports.NotionMeResponseSchema=ce,exports.NotionSearchPagesResponseSchema=se,exports.NotionUpsertResponseSchema=oe,exports.NumberAsStringCodec=A,exports.O1_HIGH_REASONING_MODEL_CONFIG=Vt,exports.O1_MINI_MODEL_CONFIG=qt,exports.O1_MINI_MODEL_ID=it,exports.O1_MODEL_CONFIG=Ht,exports.O1_MODEL_ID=st,exports.O3_MINI_HIGH_REASONING_MODEL_CONFIG=Jt,exports.O3_MINI_MODEL_CONFIG=zt,exports.O3_MINI_MODEL_ID=at,exports.OAUTH_PROVIDERS=ds,exports.OAUTH_USE_CASES=ls,exports.OAuthAPI=as,exports.Ok=S,exports.PROCESS_ACTION_TOP_K=768,exports.PROCESS_SCHEMA_ALLOWED_TYPES=["string","number","boolean"],exports.PROVIDERS_WITH_WORKSPACE_CONFIGURATIONS=ms,exports.ParsedNotionDatabaseSchema=je,exports.PatchDataSourceTableRequestBodySchema=Cn,exports.PatchDataSourceViewSchema=An,exports.PatchSpaceMembersRequestBodySchema=gn,exports.PatchSpaceRequestBodySchema=xn,exports.PlatformActionsProviders=["github"],exports.PostDataSourceDocumentRequestBodySchema=Tn,exports.PostDataSourceViewSchema=vn,exports.PostDataSourceWithNameDocumentRequestBodySchema=wn,exports.PostNotionSyncPayloadSchema=In,exports.PostOrPatchAgentConfigurationRequestBodySchema=Yr,exports.PostSpaceRequestBodySchema=_n,exports.RATE_LIMITER_PREFIX=Ws,exports.REASONING_EFFORT_IDS=qe,exports.ROLES=zo,exports.RateLimitError=Fs,exports.ReasoningEffortCodec=Qe,exports.RoleSchema=Qo,exports.SUBSCRIPTION_STATUSES=["active","ended","ended_backend_only"],exports.SUPPORTED_MODEL_CONFIGS=Tr,exports.SUPPORTED_OPERATIONS=["admin","read","write"],exports.SalesforceCredentialsSchema=Is,exports.SlackCommandSchema=U,exports.SlackConfigurationTypeSchema=me,exports.SlugifiedString=C,exports.SnowflakeCredentialsSchema=gs,exports.TABLE_PREFIX=Zr,exports.TEMPLATES_TAGS_CONFIG=qn,exports.TEMPLATES_TAG_CODES=Vn,exports.TEMPLATE_VISIBILITIES=Xn,exports.TIME_FRAME_UNITS=We,exports.TOGETHERAI_DEEPSEEK_R1_MODEL_CONFIG=Ir,exports.TOGETHERAI_DEEPSEEK_R1_MODEL_ID=Dt,exports.TOGETHERAI_DEEPSEEK_V3_MODEL_CONFIG=vr,exports.TOGETHERAI_DEEPSEEK_V3_MODEL_ID=Ot,exports.TOGETHERAI_LLAMA_3_3_70B_INSTRUCT_TURBO_MODEL_CONFIG=_r,exports.TOGETHERAI_LLAMA_3_3_70B_INSTRUCT_TURBO_MODEL_ID=Ct,exports.TOGETHERAI_QWEN_2_5_CODER_32B_INSTRUCT_MODEL_CONFIG=gr,exports.TOGETHERAI_QWEN_2_5_CODER_32B_INSTRUCT_MODEL_ID=At,exports.TOGETHERAI_QWEN_72B_INSTRUCT_MODEL_CONFIG=xr,exports.TOGETHERAI_QWEN_72B_INSTRUCT_MODEL_ID=kt,exports.TOGETHERAI_QWEN_QWQ_32B_PREVIEW_MODEL_CONFIG=yr,exports.TOGETHERAI_QWEN_QWQ_32B_PREVIEW_MODEL_ID=Rt,exports.TRACKER_FREQUENCIES=[{label:"Daily (Mon-Fri)",value:"0 17 * * 1-5"},{label:"Weekly on Monday",value:"0 17 * * 1"},{label:"Weekly on Tuesday",value:"0 17 * * 2"},{label:"Weekly on Wednesday",value:"0 17 * * 3"},{label:"Weekly on Thursday",value:"0 17 * * 4"},{label:"Weekly on Friday",value:"0 17 * * 5"}],exports.TemplateVisibilityCodec=Zn,exports.TemporalCheckQueueResponseSchema=pe,exports.TemporalCommandSchema=j,exports.TemporalUnprocessedWorkflowsResponseSchema=le,exports.TextExtraction=ei,exports.TimeframeUnitCodec=Be,exports.UNIQUE_SPACE_KINDS=os,exports.UpdateConnectorConfigurationTypeSchema=xe,exports.UpdateConnectorRequestBodySchema=Ie,exports.UpsertContextSchema=Sn,exports.WEBCRAWLER_DEFAULT_CONFIGURATION={url:"",depth:2,maxPageToCrawl:50,crawlMode:"website",crawlFrequency:"monthly",headers:{}},exports.WEBCRAWLER_MAX_DEPTH=5,exports.WEBCRAWLER_MAX_PAGES=512,exports.WHITELISTABLE_FEATURES=Ps,exports.WebCrawlerConfigurationTypeSchema=ge,exports.WebCrawlerHeaderRedactedValue="<REDACTED>",exports.WebcrawlerCommandSchema=M,exports.WebsearchActionOutputSchema=Fn,exports.WebsearchAppActionOutputSchema=Gn,exports.ZendeskCheckIsAdminResponseSchema=Y,exports.ZendeskCommandSchema=J,exports.ZendeskCountTicketsResponseSchema=Q,exports.ZendeskFetchBrandResponseSchema=Z,exports.ZendeskFetchTicketResponseSchema=X,exports.assertNever=qo,exports.cacheWithRedis=function(e,t,r,n){if(r>864e5)throw new Error("ttlMs should be less than 24 hours");return Re(Ce().mark((function o(){var s,i,a,u,c,p=arguments;return Ce().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n){o.next=5;break}if(s=process.env.REDIS_CACHE_URI){o.next=4;break}throw new Error("REDIS_CACHE_URI is not set");case 4:n=s;case 5:return i=void 0,a="cacheWithRedis-"+e.name+"-"+t.apply(void 0,p),o.prev=7,o.next=10,Ts({origin:"cache_with_redis",redisUri:n});case 10:return i=o.sent,o.next=13,i.get(a);case 13:if(!(u=o.sent)){o.next=16;break}return o.abrupt("return",JSON.parse(u));case 16:return o.prev=16,o.next=19,As(a);case 19:return o.next=21,i.get(a);case 21:if(!(u=o.sent)){o.next=24;break}return o.abrupt("return",JSON.parse(u));case 24:return o.next=26,e.apply(void 0,p);case 26:return c=o.sent,o.next=29,i.set(a,JSON.stringify(c),{PX:r});case 29:return o.abrupt("return",c);case 30:return o.prev=30,ks(a),o.finish(30);case 33:if(o.prev=33,!i){o.next=37;break}return o.next=37,i.quit();case 37:return o.finish(33);case 38:case"end":return o.stop()}}),o,null,[[7,,33,38],[16,,30,33]])})))},exports.compareAgentsForSort=function(e,t){if(e.userFavorite&&!t.userFavorite)return-1;if(t.userFavorite&&!e.userFavorite)return 1;if(e.sId===exports.GLOBAL_AGENTS_SID.DUST)return-1;if(t.sId===exports.GLOBAL_AGENTS_SID.DUST)return 1;if(e.sId===exports.GLOBAL_AGENTS_SID.GPT4)return-1;if(t.sId===exports.GLOBAL_AGENTS_SID.GPT4)return 1;if("global"!==e.scope&&"global"===t.scope)return-1;if("global"!==t.scope&&"global"===e.scope)return 1;var r=Cr.indexOf(e.sId),n=Cr.indexOf(t.sId);return-1!==r&&-1!==n?r-n:-1!==r?-1:-1!==n?1:e.name.localeCompare(t.name,"en",{sensitivity:"base"})},exports.concurrentExecutor=function(e,t,r){return ri.apply(this,arguments)},exports.connectionStrategyToHumanReadable=function(e){switch(e){case"okta":return"Okta";case"samlp":return"SAML";case"waad":return"Microsoft Entra ID";default:qo(e)}},exports.contentTypeForExtension=function(e){var t;return(null==(t=Object.entries(en).find((function(t){return t[1].exts.includes(e)})))?void 0:t[0])||null},exports.createIoTsCodecFromArgs=function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o=n[r],s=o[0],i=o[1];switch(i.type){case"text":case"string":t[s]=v.string;break;case"number":t[s]=v.number;break;case"boolean":t[s]=v.boolean;break;case"enum":if(!Array.isArray(i.values)||i.values.length<2)throw new Error('Enum argument "'+s+'" must have at least two values');t[s]=v.union([v.literal(i.values[0]),v.literal(i.values[1])].concat(i.values.slice(2).map((function(e){return v.literal(e)}))))}}return v.type(t)},exports.createRangeCodec=w,exports.credentialsFromProviders=function(e){var t={};return e.forEach((function(e){var r=JSON.parse(e.config);switch(e.providerId){case"openai":t.OPENAI_API_KEY=r.api_key;break;case"cohere":t.COHERE_API_KEY=r.api_key;break;case"ai21":t.AI21_API_KEY=r.api_key;break;case"azure_openai":t.AZURE_OPENAI_API_KEY=r.api_key,t.AZURE_OPENAI_ENDPOINT=r.endpoint;break;case"anthropic":t.ANTHROPIC_API_KEY=r.api_key;break;case"mistral":t.MISTRAL_API_KEY=r.api_key;break;case"textsynth":t.TEXTSYNTH_API_KEY=r.api_key;break;case"serpapi":t.SERP_API_KEY=r.api_key;break;case"serper":t.SERPER_API_KEY=r.api_key;break;case"browserlessapi":t.BROWSERLESS_API_KEY=r.api_key;break;case"google_ai_studio":t.GOOGLE_AI_STUDIO_API_KEY=r.api_key;break;case"togetherai":t.TOGETHERAI_API_KEY=r.api_key;break;case"deepseek":t.DEEPSEEK_API_KEY=r.api_key;break;case"fireworks":t.FIREWORKS_API_KEY=r.api_key}})),t},exports.decrypt=function(e,t){var r=ii(t).substring(0,16),n=_.createDecipheriv("aes-256-cbc",ai(t),r);return n.update(e,"hex","utf8")+n.final("utf8")},exports.defaultSelectionConfiguration=function(e){return{dataSourceView:e,isSelectAll:!1,selectedResources:[],tagsFilter:null}},exports.dustManagedCredentials=Uo,exports.encrypt=function(e,t){var r=ii(t).substring(0,16),n=_.createCipheriv("aes-256-cbc",ai(t),r);return n.update(e,"utf8","hex")+n.final("hex")},exports.ensureFileSize=function(e,t){var r=nn(e);return!!r&&t<=$r[r.cat]},exports.errorToString=oi,exports.expireRateLimiterKey=function(e){return Vs.apply(this,arguments)},exports.extensionsForContentType=function(e){var t=nn(e);return t?t.exts:[]},exports.formatUserFullName=function(e){return e?[e.firstName,e.lastName].filter(Boolean).join(" "):null},exports.generateTailwindBackgroundColors=function(){var e=[];return jn.forEach((function(t){Kn.forEach((function(r){e.push("bg-"+t+"-"+r)}))})),e},exports.getConnectionCredentials=function(e){return ps.apply(this,arguments)},exports.getDustAppRunResultsFileTitle=function(e){var t=e.appName,r=e.resultsFileContentType.split("/").pop(),n=t+"_output";return r&&(n+="."+r),n},exports.getFileFormatCategory=function(e){var t=nn(e);return t?t.cat:null},exports.getGlobalAgentAuthorName=function(e){switch(e){case exports.GLOBAL_AGENTS_SID.GPT4:case exports.GLOBAL_AGENTS_SID.O1:case exports.GLOBAL_AGENTS_SID.O1_MINI:case exports.GLOBAL_AGENTS_SID.O1_HIGH_REASONING:case exports.GLOBAL_AGENTS_SID.O3_MINI:return"OpenAI";case exports.GLOBAL_AGENTS_SID.CLAUDE_INSTANT:case exports.GLOBAL_AGENTS_SID.CLAUDE_3_OPUS:case exports.GLOBAL_AGENTS_SID.CLAUDE_3_SONNET:case exports.GLOBAL_AGENTS_SID.CLAUDE_3_7_SONNET:case exports.GLOBAL_AGENTS_SID.CLAUDE_3_HAIKU:case exports.GLOBAL_AGENTS_SID.CLAUDE_2:return"Anthropic";case exports.GLOBAL_AGENTS_SID.MISTRAL_LARGE:case exports.GLOBAL_AGENTS_SID.MISTRAL_MEDIUM:case exports.GLOBAL_AGENTS_SID.MISTRAL_SMALL:return"Mistral";case exports.GLOBAL_AGENTS_SID.GEMINI_PRO:return"Google";case exports.GLOBAL_AGENTS_SID.DEEPSEEK_R1:return"DeepSeek";default:return"Dust"}},exports.getGoogleIdsFromSheetContentNodeInternalId=function(e){var t=e.split("-sheet-");return{googleFileId:t[0].replace("google-spreadsheet-",""),googleSheetId:t[1]}},exports.getGoogleSheetContentNodeInternalId=function(e,t){return Fe(e,t)},exports.getGoogleSheetTableId=Fe,exports.getGroupIdsFromHeaders=function(e){var t=e[uo.toLowerCase()];return"string"==typeof t&&t.trim().length>0?t.split(",").map((function(e){return e.trim()})):void 0},exports.getHeaderFromGroupIds=function(e){var t;if(e)return(t={})[uo]=e.join(","),t},exports.getHeaderFromUserEmail=function(e){var t;if(e)return(t={})[Zo]=e,t},exports.getIntercomSyncWorkflowId=function(e){return"intercom-sync-"+e},exports.getLargeWhitelistedModel=function(e){return Ze(e,"anthropic")?$t:Ze(e,"openai")?Kt:Ze(e,"google_ai_studio")?cr:Ze(e,"mistral")?sr:null},exports.getNotionDatabaseTableId=Ke,exports.getNotionDatabaseTableIdFromContentNodeInternalId=function(e){return Ke(e)},exports.getNotionWorkflowId=function(e,t){var r="workflow-notion-"+e;return t&&(r+="-garbage-collector"),r},exports.getOAuthConnectionAccessToken=function(e){return cs.apply(this,arguments)},exports.getProviderFromRetrievedDocument=He,exports.getSanitizedHeaders=function(e){try{var t=e.reduce((function(e,t){var r="__dust_id"===t?t:ci(t);if(e.includes(r)&&r.length){for(var n=!1,o=2;o<64;o++)if(!e.includes(ci(r+"_"+o))){e.push(ci(r+"_"+o)),n=!0;break}if(!n)throw new pi('Failed to generate unique slugified name for header "'+t+'" after multiple attempts.')}else e.push(r);return e}),[]);return new S(t)}catch(e){return e instanceof Error?new b(e):new b(new Error("An unknown error occurred"))}},exports.getSmallWhitelistedModel=function(e){return Ze(e,"openai")?Bt:Ze(e,"anthropic")?tr:Ze(e,"google_ai_studio")?pr:Ze(e,"mistral")?ar:null},exports.getSupportedFileExtensions=function(e){return void 0===e&&(e=void 0),Xr(Qr(Object.values(en).flatMap((function(t){return e&&t.cat!==e?[]:t.exts}))))},exports.getSupportedInlinedContentType=function(){var e=on(),t=e[0],r=e[1],n=e.slice(2);return v.union([v.literal(t),v.literal(r)].concat(n.map((function(e){return v.literal(e)}))))},exports.getSupportedNonImageFileExtensions=function(){return Xr(Qr(Object.values(en).flatMap((function(e){return"image"!==e.cat?e.exts:[]}))))},exports.getSupportedNonImageMimeTypes=on,exports.getTablesQueryResultsFileAttachments=function(e){var t=e.resultsFileId,r=e.resultsFileSnippet,n=e.sectionFileId;if(!t||!r)return null;var o=Pn({output:e.output}),s="";return n&&(s='\n<file id="'+n+'" type="application/vnd.dust.section.json" title="'+o+' (Results optimized for search)" />'),'<file id="'+t+'" type="text/csv" title="'+o+'">\n'+r+"\n</file>"+s},exports.getTablesQueryResultsFileTitle=Pn,exports.getTimeframeSecondsFromLiteral=function(e){switch(e){case"day":return 86400;case"lifetime":return 2592e3;default:return 0}},exports.getTitleFromRetrievedDocument=function(e){if("slack"===He(e))for(var t,r=Ue(e.tags);!(t=r()).done;){var n=t.value;if(n.startsWith("channelName:"))return"#"+n.substring(12)}for(var o,s=Ue(e.tags);!(o=s()).done;){var i=o.value;if(i.startsWith("title:"))return i.substring(6)}return e.documentId},exports.getUserEmailFromHeaders=function(e){var t=e[Zo];if("string"==typeof t)return t},exports.getZendeskGarbageCollectionWorkflowId=function(e){return"zendesk-gc-"+e},exports.getZendeskSyncWorkflowId=function(e){return"zendesk-sync-"+e},exports.googleDriveIncrementalSyncWorkflowId=function(e){return"googleDrive-IncrementalSync-"+e},exports.guessDelimiter=di,exports.hasRolePermissions=function(e){return"roles"in e},exports.ioTsEnum=T,exports.ioTsParsePayload=function(e,r){var n=r.decode(e);if(t.isLeft(n)){var o=I.formatValidationErrors(n.left);return new b(o)}return new S(n.right)},exports.isAPIErrorResponse=function(e){return"object"==typeof e&&null!==e&&"error"in e&&function(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&"type"in e&&"string"==typeof e.type}(e.error)},exports.isActionResponseBase=function(e){return t.isRight(co.decode(e))},exports.isActiveRoleType=function(e){return Jo.includes(e)},exports.isAdmin=function(e){if(!e)return!1;switch(e.role){case"admin":return!0;case"builder":case"user":case"none":return!1;default:qo(e.role)}},exports.isAgentMention=function(e){return void 0!==e.configurationId},exports.isAgentMessageType=function(e){return"agent_message"===e.type},exports.isBaseActionClass=function(e){return e instanceof Nn},exports.isBigFileSize=function(e){return e>5e6},exports.isBigQueryWithLocationCredentials=function(e){return"type"in e&&"project_id"in e&&"location"in e},exports.isBrowseActionType=function(e){return"browse_action"===e.type},exports.isBrowseConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"browse_configuration"===e.type},exports.isBuilder=function(e){if(!e)return!1;switch(e.role){case"admin":case"builder":return!0;case"user":case"none":return!1;default:qo(e.role)}},exports.isConfluenceNotFoundError=function(e){return e instanceof Ge&&404===e.status},exports.isConnectorError=function(e){return Go.includes(e)},exports.isConnectorProvider=function(e){return io.includes(e)},exports.isConnectorsAPIError=fe,exports.isContentFragmentInputWithContentType=function(e){return"contentType"in e},exports.isContentFragmentMessageTypeModel=function(e){return"content_fragment"===e.role},exports.isContentFragmentType=function(e){return"content_fragment"===e.type},exports.isConversationIncludeFileConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"conversation_include_file_configuration"===e.type},exports.isConversationIncludeFileConfigurationActionType=function(e){return"conversation_include_file_action"===e.type},exports.isCoreAPIError=Fo,exports.isCredentialProvider=function(e){return _s.includes(e)},exports.isDataSourceNameValid=function(e){return 0===e.trim().length?new b("DataSource name cannot be empty"):e.startsWith("managed-")?new b("DataSource name cannot start with the prefix `managed-`"):new S(void 0)},exports.isDataSourceViewCategoryWithoutApps=function(e){return kn(e)&&"apps"!==e},exports.isDepthOption=function(e){return _e.includes(e)},exports.isDevelopment=function(){return!1},exports.isDisplayCodeRequest=so,exports.isDownloadFileRequest=oo,exports.isDustAppRunActionType=function(e){return"dust_app_run_action"===e.type},exports.isDustAppRunConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"dust_app_run_configuration"===e.type},exports.isDustWorkspace=function(e){return e.sId===process.env.PRODUCTION_DUST_WORKSPACE_ID},exports.isEmptyString=function(e){return null==e||""===e.trim()},exports.isGetCodeToExecuteRequest=to,exports.isGetFileRequest=eo,exports.isGithubCreateIssueActionType=function(e){return"github_create_issue_action"===e.type},exports.isGithubCreateIssueConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"github_create_issue_configuration"===e.type},exports.isGithubGetPullRequestActionType=function(e){return"github_get_pull_request_action"===e.type},exports.isGithubGetPullRequestConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"github_get_pull_request_configuration"===e.type},exports.isGlobalGroupKind=function(e){return"global"===e},exports.isGoogleSheetContentNodeInternalId=function(e){return e.startsWith("google-spreadsheet-")&&e.includes("-sheet-")},exports.isGroupKind=function(e){return ao.includes(e)},exports.isMaxMessagesTimeframeType=function(e){return ts.includes(e)},exports.isMembershipRoleType=function(e){return es.includes(e)},exports.isModelId=function(e){return Ut.includes(e)},exports.isModelProviderId=function(e){return Ve.includes(e)},exports.isModjoCredentials=function(e){return"api_key"in e},exports.isOAuthAPIError=is,exports.isOAuthConnectionType=hs,exports.isOAuthProvider=fs,exports.isOAuthUseCase=function(e){return ls.includes(e)},exports.isOnlyAdmin=function(e){return!!e&&"admin"===e.role},exports.isOnlyBuilder=function(e){return!!e&&"builder"===e.role},exports.isOnlyUser=function(e){return!!e&&"user"===e.role},exports.isProcessActionType=function(e){return"process_action"===e.type},exports.isProcessConfiguration=Ln,exports.isProviderWhitelisted=Ze,exports.isProviderWithWorkspaceConfiguration=function(e){return ms.includes(e)},exports.isPublicySupportedUseCase=function(e){return["conversation"].includes(e)},exports.isReasoningConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"reasoning_configuration"===e.type},exports.isRetrievalActionType=function(e){return"retrieval_action"===e.type},exports.isRetrievalConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"retrieval_configuration"===e.type},exports.isRowMatchingSchema=function(e,t){for(var r,n=function(){var e=s[o],r=e[0],n=e[1];if(null===n)return 0;if("string"==typeof n&&0===n.trim().length)return 0;var i=t.find((function(e){return e.name===r}));return i?"int"===i.value_type&&"number"!=typeof n||"float"===i.value_type&&"number"!=typeof n||"text"===i.value_type&&"string"!=typeof n||"bool"===i.value_type&&"boolean"!=typeof n||"datetime"===i.value_type&&("object"!=typeof n||!n||"number"!=typeof n.epoch||n.string_value&&"string"!=typeof n.string_value)?{v:!1}:void 0:{v:!1}},o=0,s=Object.entries(e.value);o<s.length;o++)if(0!==(r=n())&&r)return r.v;return!0},exports.isSalesforceCredentials=function(e){return"client_id"in e&&"client_secret"in e},exports.isSearchLabelsConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"search_labels_configuration"===e.type},exports.isSetContentHeightRequest=ro,exports.isSetErrorMessageRequest=no,exports.isSlackAutoReadPatterns=function(e){return he.is(e)},exports.isSlackbotWhitelistType=function(e){return"summon_agent"===e||"index_messages"===e},exports.isSlugified=function(e){return/^[a-z0-9_]+$/.test(e)},exports.isSnowflakeCredentials=function(e){return"username"in e&&"password"in e},exports.isString=function(e){return"string"==typeof e},exports.isSupportedDelimitedTextContentType=function(e){var t=nn(e);return!!t&&"delimited"===t.cat},exports.isSupportedEnterpriseConnectionStrategy=function(e){return ss.includes(e)},exports.isSupportedFileContentType=rn,exports.isSupportedImageContentType=function(e){var t=nn(e);return!!t&&"image"===t.cat},exports.isSupportedModel=wr,exports.isSupportedResourceType=function(e){return Vo.includes(e)},exports.isSystemGroupKind=function(e){return"system"===e},exports.isTablesQueryActionType=function(e){return"tables_query_action"===e.type},exports.isTablesQueryConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"tables_query_configuration"===e.type},exports.isTemplateTagCodeArray=function(e){return Array.isArray(e)&&e.every((function(e){return Vn.includes(e)}))},exports.isTextContent=function(e){return"text"===e.type},exports.isTextExtractionSupportedContentType=function(e){return Zs.includes(e)},exports.isTimeFrame=function(e){return void 0!==e.duration&&void 0!==e.unit},exports.isUniqueSpaceKind=function(e){return os.includes(e)},exports.isUser=function(e){if(!e)return!1;switch(e.role){case"admin":case"builder":case"user":return!0;case"none":return!1;default:qo(e.role)}},exports.isUserMessageType=function(e){return"user_message"===e.type},exports.isUserMessageTypeModel=function(e){return"user"===e.role},exports.isValidContentNodesViewType=function(e){return"document"===e||"table"===e||"all"===e},exports.isValidDataSourceViewCategory=kn,exports.isValidDate=function(e){return!isNaN(e.valueOf())},exports.isValidSalesforceClientId=function(e){return"string"==typeof e&&e.trim().length>0},exports.isValidSalesforceClientSecret=function(e){return"string"==typeof e&&e.trim().length>0},exports.isValidSalesforceDomain=function(e){return"string"==typeof e&&e.startsWith("https://")&&e.endsWith(".salesforce.com")},exports.isValidZendeskSubdomain=function(e){return"string"==typeof e&&/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?$/.test(e)},exports.isVisualizationRPCRequest=function(e){return"object"==typeof e&&null!==e&&(to(e)||eo(e)||oo(e)||ro(e)||no(e)||so(e))},exports.isWebCrawlerConfiguration=function(e){return void 0!==(null==e?void 0:e.url)&&void 0!==(null==e?void 0:e.depth)&&void 0!==(null==e?void 0:e.maxPageToCrawl)&&void 0!==(null==e?void 0:e.crawlMode)&&void 0!==(null==e?void 0:e.crawlFrequency)&&void 0!==(null==e?void 0:e.headers)},exports.isWebsearchActionType=function(e){return"websearch_action"===e.type},exports.isWebsearchConfiguration=function(e){return!!e&&"object"==typeof e&&"type"in e&&"websearch_configuration"===e.type},exports.isWebsiteOrFolderCategory=function(e){return"website"===e||"folder"===e},exports.isWhitelistableFeature=function(e){return Ps.includes(e)},exports.labsTranscriptsProviders=["google_drive","gong","modjo"],exports.makeConfluenceSyncWorkflowId=function(e){return"confluence-sync-"+e},exports.maxFileSizeToHumanReadable=function(e,t){return void 0===t&&(t=0),e<1024?e.toFixed(t)+" B":e<1048576?(e/1024).toFixed(t)+" KB":e<1073741824?(e/1048576).toFixed(t)+" MB":(e/1073741824).toFixed(t)+" GB"},exports.md5=ii,exports.microsoftGarbageCollectionWorkflowId=function(e){return"microsoft-garbageCollection-"+e},exports.microsoftIncrementalSyncWorkflowId=function(e){return"microsoft-incrementalSync-"+e},exports.normalizeError=function(e){return e instanceof Error?e:new Error(oi(e))},exports.pagePrefixesPerMimeType=Xs,exports.parseAndStringifyCsv=function(e){return hi.apply(this,arguments)},exports.pluralize=function(e){return 1!==e?"s":""},exports.prettifyGroupName=function(e){return"global"===e.kind?"Company Data":e.name.replace("Group for Space ","")},exports.rateLimiter=function(e){return Hs.apply(this,arguments)},exports.redactString=function(e,t){return"string"!=typeof e||e.length<=t?e:"".repeat(e.length-t)+e.slice(-t)},exports.removeNulls=Qr,exports.renderSchemaPropertiesAsJSONSchema=function(e){var t={};return e.length>0?e.forEach((function(e){t[e.name]={type:e.type,description:e.description}})):t={required_data:{type:"string",description:"Minimal (short and concise) piece of information extracted to follow instructions"}},t},exports.safeParseJSON=function(e){try{var t=JSON.parse(e);return new S(t)}catch(e){return e instanceof Error?new b(e):new b(new Error("Unexpected error: JSON parsing failed."))}},exports.safeSubstring=function(e,t,r){for(;(n=e.charCodeAt(t))>=56320&&n<=57343;)t++;var n;for(void 0===r&&(r=e.length);ui(e.charCodeAt(r-1));)r--;return e.substring(t,r)},exports.sanitizeString=function(e){return e.trim().toLowerCase()},exports.sectionFullText=function e(t){return""+(t.prefix||"")+(t.content||"")+t.sections.map(e).join("")},exports.sendInitDbMessage=function(e){return Ls.apply(this,arguments)},exports.sendUserOperationMessage=function(e){return ti.apply(this,arguments)},exports.setupGlobalErrorHandler=function(e){si?e.info({},"Global error handler already setup"):(si=!0,process.on("unhandledRejection",(function(t,r){var o=n.v4();console.error("unhandledRejection",r,t,o),r.catch((function(r){e.error({error:r,panic:!0,uuid:o,reason:t},"Unhandled Rejection")}))})),process.on("uncaughtException",(function(t){e.error({error:t,panic:!0},"Uncaught Exception")})))},exports.setupOAuthConnection=function(e){return Es.apply(this,arguments)},exports.slugify=ci,exports.stripNullBytes=function(e){return e.replace(/\0/g,"")},exports.supportedEnterpriseConnectionStrategies=ss,exports.supportedResourceTypes=Vo,exports.supportedUploadableContentType=tn,exports.throwIfInvalidAgentConfiguration=function(e){e.actions.forEach((function(e){if(Ln(e)&&("auto"===e.relativeTimeFrame||"none"===e.relativeTimeFrame))throw new Error("Invalid configuration: process must have a definite time frame")}));var t=e;if(e&&"global"===e.scope)throw new Error("Cannot create global agent");if(t){if("global"===t.scope)throw new Error("Cannot edit global agent");if("archived"===t.status)throw new Error("Cannot edit archived agent")}},exports.truncate=function(e,t,r){return void 0===r&&(r="..."),e.length>t?""+e.substring(0,t-r.length)+r:e},exports.validCommands=["getFile","getCodeToExecute","setContentHeight","setErrorMessage"];
//# sourceMappingURL=types.cjs.production.min.js.map
